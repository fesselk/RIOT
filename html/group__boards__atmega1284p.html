<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Standalone ATmega1284P</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="jquery.scrollTo.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
        <script>
            function displaySR(){
            searchBox.Search();
            var rhtml=(document.getElementById('MSearchResults').contentWindow.document.body.innerHTML).replace(/href=\"\.\.\//g,'href="');
            document.getElementById('MSearchResultsWindow').style.display='none';
            document.getElementById('top').append(document.getElementById('MSearchSelectWindow'));
            document.getElementById('top').append(document.getElementById('MSearchResultsWindow'));
            document.getElementById('doc-content').innerHTML=rhtml;
            }
            function modSearch(){
            if(!searchBox.doxySearch){
                searchBox.doxySearch=searchBox.Search
                searchBox.Search= function(){this.doxySearch();
                var r=document.getElementById('MSearchResultsWindow');console.log(r.style);
                if(parseInt(r.style.left)<0)r.style.left=0;
                var x=document.getElementById('MSearchResults');
                if(x.scrollWidth>window.screen.width)x.style.width=window.screen.width-2+'px';
                var f=document.getElementById('riot-searchform');
                if(parseInt( r.style.top) < f.offsetTop+f.scrollHeight) r.style.top = f.offsetTop+f.scrollHeight+'px';}
            }
            }
        </script>
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right"
                    onsubmit="try{
                        displaySR();
                    }finally{
                            return false;
                    }">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event); modSearch();">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__boards__atmega1284p.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">Standalone ATmega1284P<div class="ingroups"><a class="el" href="group__boards.html">Boards</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Support for using the ATmega1284P as standalone board.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Support for using the ATmega1284P as standalone board. </p>
<h2><a class="anchor" id="autotoc_md252"></a>
Overview</h2>
<p>As the ATmega1284P can run from the internal oscillator, placing it on a breadboard, connecting an USB-UART adapter and power is enough to run RIOT on it. (An ISP programmer will be needed to program it; or to program a bootloader to subsequently allow programming via UART.)</p>
<h3><a class="anchor" id="autotoc_md253"></a>
MCU</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">MCU </th><th class="markdownTableHeadLeft">ATmega1284p  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Family </td><td class="markdownTableBodyLeft">AVR/ATmega  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Vendor </td><td class="markdownTableBodyLeft">Microchip (previously Atmel)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">RAM </td><td class="markdownTableBodyLeft">16KiB  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Flash </td><td class="markdownTableBodyLeft">128KiB  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">EEPROM </td><td class="markdownTableBodyLeft">4KiB  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Frequency </td><td class="markdownTableBodyLeft">8MHz (up to 20MHz with external clock)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Timers </td><td class="markdownTableBodyLeft">3 (2x 8bit, 1x 16bit)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ADCs </td><td class="markdownTableBodyLeft">6 analog input pins  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">UARTs </td><td class="markdownTableBodyLeft">1  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SPIs </td><td class="markdownTableBodyLeft">1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">I2Cs </td><td class="markdownTableBodyLeft">1 (called TWI)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Vcc </td><td class="markdownTableBodyLeft">2.7V - 5.5V (when clocked at 8MHz)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Datasheet </td><td class="markdownTableBodyLeft"><a href="http://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-42719-ATmega1284P_Datasheet.pdf">Official datasheet</a>  </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md254"></a>
Pinout</h3>
<p> <style>div.image img[src="http://i.imgur.com/ayagBbM.png"]{width:50%;}</style> </p><div class="image">
<img src="http://i.imgur.com/ayagBbM.png" alt=""/>
<div class="caption">
Pinout of the ATmega1284P</div></div>
<p><br  />
</p>
<p>The pinout image was posted in the <a href="https://forum.arduino.cc/index.php?topic=322745.0">Arduino Forum</a>. All credit goes to its poster, hansibull.</p>
<h3><a class="anchor" id="autotoc_md255"></a>
Clock Frequency</h3>
<p>The ATmega1284P has two internal oscillators clocked at 8MHz and at 128kHz that allow it to be operated without any external clock source or crystal. By default the fuses are configured to use the internal 8MHz oscillator, but the <code>CKDIV8</code> fuse is set, so that the clock is divided down to 1MHz. By disabling the <code>CKDIV8</code> fuse the clock will operate at 8MHz. This is highly encouraged, and can be done with:</p>
<div class="fragment"><div class="line">avrdude -c atmelice -p m1284p -B 32 -U lfuse:w:0xc2:m</div>
</div><!-- fragment --><p>(Replace <code>atmelice</code> with the programmer you are using. The -B 32 might be needed for some programmers to successfully communicate with ATmegas clocked at less than 2MHz. It will no longer be needed after disabling <code>CKDIV8</code>.)</p>
<p>By setting the environment variable <code>ATMEGA1284P_CLOCK</code> to a custom frequency in Hz (e.g. <code>1000000</code> for 1MHz), this core clock can be changed easily. Refer to the datasheet on how to configure the ATmega1284p to use an external crystal, an external clock source or the clock divider.</p>
<h3><a class="anchor" id="autotoc_md256"></a>
Relation Between Supply Voltage, Clock Frequency and Power Consumption</h3>
<p>A higher supply voltage results in a higher current drawn. Thus, lower power consumption can be achieved by using a lower supply voltage. However, higher clock frequencies require higher supply voltages for reliable operation.</p>
<p>The lowest possible supply voltage at 8 MHz is 2.7V (with some safety margin).</p>
<h2><a class="anchor" id="autotoc_md257"></a>
Flashing the Device</h2>
<p>In order to flash the ATmega1284P without a bootloader, an ISP programmer is needed. Connect the programmer as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">ISCP pin </th><th class="markdownTableHeadLeft">ATmega1284P  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">MISO </td><td class="markdownTableBodyLeft">7/PB6/MISO  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">VCC </td><td class="markdownTableBodyLeft">10/VCC  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SCK </td><td class="markdownTableBodyLeft">8/PB7/SCK  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">MOSI </td><td class="markdownTableBodyLeft">6/PB5/MOSI  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">RESET </td><td class="markdownTableBodyLeft">9/RESET  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Ground </td><td class="markdownTableBodyLeft">11/GND  </td></tr>
</table>
<p>The tool <code>avrdude</code> needs to be installed. When using the Atmel ICE for connected via JTAG for programming, running </p><pre class="fragment">make BOARD=atmega1284p flash
</pre><p>will take care of everything. To use the programmer <code>&lt;FOOBAR&gt;</code> instead, run </p><pre class="fragment">make BOARD=atmega1284p PROGRAMMER=&lt;FOOBAR&gt; flash
</pre><h2><a class="anchor" id="autotoc_md258"></a>
Serial Terminal</h2>
<p>Connect a TTL adapter with pins 14/RXD0 and 15/TXD0 an run </p><pre class="fragment">make BOARD=atmega1284p term
</pre><p>Please note that the supply voltage should be compatible with the logic level of the TTL adapter. Usually everything between 3.3 V and 5 V should work.</p>
<h2><a class="anchor" id="autotoc_md259"></a>
On-Chip Debugging</h2>
<p>In order to debug the ATmega1284P, an compatible debugger is needed. The Atmel ICE is the <strike>cheapest</strike> least expensive option currently available. (But at least it can program and debug pretty much all Atmel AVR and ARM chips.)</p>
<p>Once the Atmel ICE is correctly connected, the ATmega1284P has the JTAG interface enabled, and the required software is installed, debugging can be started using </p><pre class="fragment">make debug
</pre><dl class="section note"><dt>Note</dt><dd>If you are using a different debugger than the Atmel ICE, you have to export the <code>AVR_DEBUGDEVICE</code> environment variable to the required flag to pass to AVaRICE, e.g. when using the AVR Dragon you have to export <code>AVR_DEBUGDEVICE=--dragon</code>. If the debug device is not connected via USB, you also need to export <code>AVR_DEBUGINTERFACE</code> to the correct value.</dd></dl>
<h4><a class="anchor" id="autotoc_md260"></a>
Software Requirements</h4>
<p>In order to debug you'll need an GDB version with AVR support and <a href="http://avarice.sourceforge.net/">AVaRICE</a>. Note that AVaRICE sadly is not being actively maintained and the latest release will not compile on most systems. Thus, unless your distribution already ships a package of the SVN version of AVaRICE, you'll have to build the tool from source.</p>
<h3><a class="anchor" id="autotoc_md261"></a>
JTAG Pin Mapping</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Pin Name </th><th class="markdownTableHeadLeft">Pin </th><th class="markdownTableHeadLeft">Signal </th><th class="markdownTableHeadLeft">Atmel ICE Pin  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">PC5 </td><td class="markdownTableBodyLeft">27 </td><td class="markdownTableBodyLeft">TDI </td><td class="markdownTableBodyLeft">JTAG-9  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">PC4 </td><td class="markdownTableBodyLeft">26 </td><td class="markdownTableBodyLeft">TDO </td><td class="markdownTableBodyLeft">JTAG-3  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">PC3 </td><td class="markdownTableBodyLeft">25 </td><td class="markdownTableBodyLeft">TMS </td><td class="markdownTableBodyLeft">JTAG-5  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">PC2 </td><td class="markdownTableBodyLeft">24 </td><td class="markdownTableBodyLeft">TCK </td><td class="markdownTableBodyLeft">JTAG-1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">VCC </td><td class="markdownTableBodyLeft">10 </td><td class="markdownTableBodyLeft">VTG </td><td class="markdownTableBodyLeft">JTAG-4  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GND </td><td class="markdownTableBodyLeft">11 </td><td class="markdownTableBodyLeft">GND </td><td class="markdownTableBodyLeft">JTAG-2  </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md262"></a>
Fuse Settings</h3>
<p>The <code>JTAGEN</code> fuse has to be set in order to use the JTAG interface. The JTAG pins will no longer be available as GPIOs when this fuse is set. With the default settings the MCUs are preprogrammed during manufacturing, the <code>JTAGEN</code> fuse is already set. So with a new and unused package, you're ready directly ready to go. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:atmega1284p_2include_2board_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="atmega1284p_2include_2board_8h.html">board.h</a></td></tr>
<tr class="memdesc:atmega1284p_2include_2board_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific definitions for the standalone ATmega1284P "board". <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:boards_2atmega1284p_2include_2periph__conf_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boards_2atmega1284p_2include_2periph__conf_8h.html">periph_conf.h</a></td></tr>
<tr class="memdesc:boards_2atmega1284p_2include_2periph__conf_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peripheral MCU configuration for the ATmega1284p standalone "board". <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Tue Nov 24 2020 19:46:59 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.17</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>
</html>
