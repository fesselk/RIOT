<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Gcoap</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <!--BEGIN SEARCHENGINE hidden-sm hidden-xs"-->
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right"
                    onsubmit="try{
                        var rhtml=document.getElementById('MSearchResults').contentWindow.document.body.innerHTML;
                        document.getElementById('MSearchResultsWindow').style.display='none';
                        document.getElementById('top').append(document.getElementById('MSearchSelectWindow'));
                        document.getElementById('top').append(document.getElementById('MSearchResultsWindow'));
                        document.getElementById('doc-content').innerHTML=rhtml;
                        }finally{
                            return false;
                    }">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event);
                              r=document.getElementById('MSearchResultsWindow');
                              if(parseInt(r.style.left)<0)r.style.left=0;">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__net__gcoap.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Gcoap<div class="ingroups"><a class="el" href="group__net.html">Networking</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>High-level interface to CoAP messaging.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>High-level interface to CoAP messaging. </p>
<p>gcoap provides a high-level interface for writing CoAP messages via RIOT's sock networking API. gcoap internalizes network event processing so an application only needs to focus on request/response handling. For a server, gcoap accepts a list of resource paths with callbacks for writing the response. For a client, gcoap provides a function to send a request, with a callback for reading the server response.</p>
<p>gcoap allocates a RIOT message processing thread, so a single instance can serve multiple applications. This approach also means gcoap uses a single UDP port, which supports RFC 6282 compression. Internally, gcoap depends on the nanocoap package for base level structs and functionality. gcoap uses nanocoap's Packet API to write message options.</p>
<p>gcoap supports the Observe extension (RFC 7641) for a server. gcoap provides functions to generate and send an observe notification that are similar to the functions to send a client request. gcoap also supports the Block extension (RFC 7959) with block-specific option functions as well as some helpers.</p>
<p><em>Contents</em></p>
<ul>
<li>Server Operation</li>
<li>Client Operation</li>
<li>Observe Server Operation</li>
<li>Block Operation</li>
<li>Proxy Operation</li>
<li>Implementation Notes</li>
<li>Implementation Status</li>
</ul>
<h2>Server Operation</h2>
<p>gcoap listens for requests on CONFIG_GCOAP_PORT, 5683 by default. You can redefine this by uncommenting the appropriate lines in gcoap's make file.</p>
<p>gcoap allows an application to specify a collection of request resource paths it wants to be notified about. Create an array of resources (<a class="el" href="structcoap__resource__t.html" title="Type for CoAP resource entry. ">coap_resource_t</a> structs) ordered by the resource path, specifically the ASCII encoding of the path characters (digit and capital precede lower case). Use <a class="el" href="group__net__gcoap.html#ga1c3b10922136af0308bd70c7bb6f0e52" title="Starts listening for resource paths. ">gcoap_register_listener()</a> at application startup to pass in these resources, wrapped in a gcoap_listener_t. Also see <em>Server path matching</em> in the base <a href="group__net__nanocoap.html">nanocoap</a> documentation.</p>
<p>gcoap itself defines a resource for <code>/.well-known/core</code> discovery, which lists all of the registered paths. See the <em>Resource list creation</em> section below for more.</p>
<h3>Creating a response</h3>
<p>An application resource includes a callback function, a coap_handler_t. After reading the request, the callback must use functions provided by gcoap to format the response, as described below. The callback <em>must</em> read the request thoroughly before calling the functions, because the response buffer likely reuses the request buffer. See <code>examples/gcoap/gcoap_cli.c</code> for a simple example of a callback.</p>
<p>Here is the expected sequence for a callback function:</p>
<p>Read request completely and parse request payload, if any. Use the <a class="el" href="structcoap__pkt__t.html" title="CoAP PDU parsing context structure. ">coap_pkt_t</a> <em>payload</em> and <em>payload_len</em> attributes.</p>
<p>If there is a payload, follow the steps below.</p>
<ol type="1">
<li>Call <a class="el" href="group__net__gcoap.html#ga1900ec9205ee6844b422312a0af5896a" title="Initializes a CoAP response packet on a buffer. ">gcoap_resp_init()</a> to initialize the response.</li>
<li>Use the coap_opt_add_xxx() functions to include any Options, for example <a class="el" href="group__net__nanocoap.html#ga23be123d046524b6b1269e26fb3150e0" title="Append a Content-Format option to the pkt buffer. ">coap_opt_add_format()</a> for Content-Format of the payload. Options <em>must</em> be written in order by option number (see "CoAP option numbers" in <a href="group__net__coap.html">CoAP defines</a>).</li>
<li>Call <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> to complete the PDU metadata. Retain the returned metadata length.</li>
<li>Write the response payload, starting at the updated <em>payload</em> pointer in the <a class="el" href="structcoap__pkt__t.html" title="CoAP PDU parsing context structure. ">coap_pkt_t</a>, for up to <em>payload_len</em> bytes.</li>
<li>Return the sum of the metadata length and payload length. If some error has occurred, return a negative errno code from the handler, and gcoap will send a server error (5.00).</li>
</ol>
<p>If no payload, call only <a class="el" href="group__net__gcoap.html#gace6fa0e224d1cd07211e22e3af75f8bd" title="Writes a complete CoAP response PDU when there is no payload. ">gcoap_response()</a> to write the full response. If you need to add Options, follow the first three steps in the list above instead.</p>
<h3>Resource list creation</h3>
<p>gcoap allows customization of the function that provides the list of registered resources for <code>/.well-known/core</code> and CoRE Resource Directory registration. By default gcoap provides <a class="el" href="group__net__gcoap.html#gaa097b4388e04ab265cf79cf38c493d07" title="Writes a resource in CoRE Link Format to a provided buffer. ">gcoap_encode_link()</a>, which lists only the target path for each link. However, an application may specify a custom function in the gcoap_listener_t it registers with gcoap. For example, this function may add parameters to provide more information about the resource, as described in RFC 6690. See the gcoap example for use of a custom encoder function.</p>
<h2>Client Operation</h2>
<p>Client operation includes two phases: creating and sending a request, and handling the response asynchronously in a client supplied callback. See <code>examples/gcoap/gcoap_cli.c</code> for a simple example of sending a request and reading the response.</p>
<h3>Creating a request</h3>
<p>Here is the expected sequence to prepare and send a request:</p>
<p>Allocate a buffer and a <a class="el" href="structcoap__pkt__t.html" title="CoAP PDU parsing context structure. ">coap_pkt_t</a> for the request.</p>
<p>If there is a payload, follow the steps below.</p>
<ol type="1">
<li>Call <a class="el" href="group__net__gcoap.html#ga38e727699633c4c12a4a54f87b8d8f66" title="Initializes a CoAP request PDU on a buffer. ">gcoap_req_init()</a> to initialize the request.</li>
<li>Optionally, mark the request confirmable by calling <a class="el" href="group__net__nanocoap.html#ga92058243dac042a617701aaedc58e45d" title="Set the message type for the given CoAP header. ">coap_hdr_set_type()</a> with COAP_TYPE_CON.</li>
<li>Use the coap_opt_add_xxx() functions to include any Options beyond Uri-Path, which was added in the first step. Options <em>must</em> be written in order by option number (see "CoAP option numbers" in <a href="group__net__coap.html">CoAP defines</a>).</li>
<li>Call <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> to complete the PDU metadata. Retain the returned metadata length.</li>
<li>Write the request payload, starting at the updated <em>payload</em> pointer in the <a class="el" href="structcoap__pkt__t.html" title="CoAP PDU parsing context structure. ">coap_pkt_t</a>, for up to <em>payload_len</em> bytes.</li>
</ol>
<p>If no payload, call only <a class="el" href="group__net__gcoap.html#gaf635d01732aa7c620271d05949103497" title="Writes a complete CoAP request PDU when there is not a payload. ">gcoap_request()</a> to write the full request. If you need to add Options, follow the first four steps in the list above instead.</p>
<p>Finally, call <a class="el" href="group__net__gcoap.html#ga45d25b1deccdf56f6fc6c490510edbe6" title="Sends a buffer containing a CoAP request to the provided endpoint. ">gcoap_req_send()</a> with the sum of the metadata length and payload length, the destination endpoint, and a callback function for the host's response.</p>
<h3>Handling the response</h3>
<p>When gcoap receives the response to a request, it executes the callback from the request. gcoap also executes the callback when a response is not received within GCOAP_RESPONSE_TIMEOUT.</p>
<p>Here is the expected sequence for handling a response in the callback.</p>
<ol type="1">
<li>Test for a server response or timeout in the <code>state</code> field of the <code>memo</code> callback parameter (<code>memo-&gt;state</code>). See the GCOAP_MEMO... constants.</li>
<li>Test the response with <a class="el" href="group__net__nanocoap.html#ga19ea0235c2b8c20bd0be3dfaa05e68c4" title="Get a message&#39;s code class (3 most significant bits of code) ">coap_get_code_class()</a> and <a class="el" href="group__net__nanocoap.html#ga00bb45bdda0c564ff8d8de2ea89b6f46" title="Get a message&#39;s code detail (5 least significant bits of code) ">coap_get_code_detail()</a>.</li>
<li>Test the response payload with the <a class="el" href="structcoap__pkt__t.html" title="CoAP PDU parsing context structure. ">coap_pkt_t</a> <em>payload_len</em> and <em>content_type</em> attributes.</li>
<li>Read the payload, if any.</li>
</ol>
<h2>Observe Server Operation</h2>
<p>A CoAP client may register for Observe notifications for any resource that an application has registered with gcoap. An application does not need to take any action to support Observe client registration. However, gcoap limits registration for a given resource to a <em>single</em> observer.</p>
<p>It is <a href="https://tools.ietf.org/html/rfc7641#section-6">suggested</a> that a server adds the 'obs' attribute to resources that are useful for observation (i.e. will produce notifications) as a hint. Keep in mind that this is not mandatory in order to enable the mechanism in RIOT, nor will it prevent a client from observing a resource that does not have this attribute in the link description. See the "Resource list creation" section above for how the gcoap example app publishes the obs attribute.</p>
<p>An Observe notification is considered a response to the original client registration request. So, the Observe server only needs to create and send the notification &ndash; no further communication or callbacks are required.</p>
<h3>Creating a notification</h3>
<p>Here is the expected sequence to prepare and send a notification:</p>
<p>Allocate a buffer and a <a class="el" href="structcoap__pkt__t.html" title="CoAP PDU parsing context structure. ">coap_pkt_t</a> for the notification, then follow the steps below.</p>
<ol type="1">
<li>Call <a class="el" href="group__net__gcoap.html#ga3918d03f99a7312946bc28d5fdb7b610" title="Initializes a CoAP Observe notification packet on a buffer, for the observer registered for a resourc...">gcoap_obs_init()</a> to initialize the notification for a resource. Test the return value, which may indicate there is not an observer for the resource. If so, you are done.</li>
<li>Use the coap_opt_add_xxx() functions to include any Options, for example <a class="el" href="group__net__nanocoap.html#ga23be123d046524b6b1269e26fb3150e0" title="Append a Content-Format option to the pkt buffer. ">coap_opt_add_format()</a> for Content-Format of the payload. Options <em>must</em> be written in order by option number (see "CoAP option numbers" in <a href="group__net__coap.html">CoAP defines</a>).</li>
<li>Call <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> to complete the PDU metadata. Retain the returned metadata length.</li>
<li>Write the notification payload, starting at the updated <em>payload</em> pointer in the <a class="el" href="structcoap__pkt__t.html" title="CoAP PDU parsing context structure. ">coap_pkt_t</a>, for up to <em>payload_len</em> bytes.</li>
</ol>
<p>Finally, call <a class="el" href="group__net__gcoap.html#gab89faee1f2f999f4d6088ec91ca620bd" title="Sends a buffer containing a CoAP Observe notification to the observer registered for a resource...">gcoap_obs_send()</a> for the resource, with the sum of the metadata length and payload length for the representation.</p>
<h3>Other considerations</h3>
<p>By default, the value for the Observe option in a notification is three bytes long. For resources that change slowly, this length can be reduced via CONFIG_GCOAP_OBS_VALUE_WIDTH.</p>
<p>A client always may re-register for a resource with the same token or with a new token to indicate continued interest in receiving notifications about it. Of course the client must not already be using any new token in the registration for a different resource. Successful registration always is indicated by the presence of the Observe option in the response.</p>
<p>To cancel registration, the server expects to receive a GET request with the Observe option value set to 1. The server does not support cancellation via a reset (RST) response to a non-confirmable notification.</p>
<h2>Block Operation</h2>
<p>gcoap provides for both server side and client side blockwise messaging for requests and responses. This section outlines how to write a message for each situation.</p>
<h3>CoAP server GET handling</h3>
<p>The server must slice the full response body into smaller payloads, and identify the slice with a Block2 option. This implementation toggles the actual writing of data as it passes over the code for the full response body. See the _riot_block2_handler() example in <a href="https://github.com/kb2ma/riot-apps/blob/kb2ma-master/gcoap-block-server/gcoap_block.c">gcoap-block-server</a>, which implements the sequence described below.</p>
<ul>
<li>Use <a class="el" href="group__net__nanocoap.html#ga847153f464dc80f7f015d3ccbceb71c4" title="Initialize a block2 slicer struct for writing the payload. ">coap_block2_init()</a> to initialize a <em>slicer</em> struct from the Block2 option in the request. The slicer tracks boundaries while writing the payload. If no option present in the initial request, the init function defaults to a payload size of 16 bytes.</li>
<li>Use <a class="el" href="group__net__gcoap.html#ga1900ec9205ee6844b422312a0af5896a" title="Initializes a CoAP response packet on a buffer. ">gcoap_resp_init()</a> to begin the response.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#ga15b410e6d2de7e20b3017b3961a6a15a" title="Add block2 option in descriptive use from a slicer object. ">coap_opt_add_block2()</a> to write the Block2 option from the slicer. Use 1 as a default for the <em>more</em> parameter. At this point, we don't know yet if this message will be the last in the block exchange. However, we must add the block option at this location in the message.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> to add a payload marker.</li>
<li>Add the payload using the <code>coap_blockwise_put_xxx()</code> functions. The slicer knows the current position in the overall body of the response. It writes only the portion of the body specified by the block number and block size in the slicer.</li>
<li>Finally, use <a class="el" href="group__net__nanocoap.html#gaf49dabd8f794e01ee318f74dfb01956b" title="Finish a block2 response. ">coap_block2_finish()</a> to finalize the block option with the proper value for the <em>more</em> parameter.</li>
</ul>
<h3>CoAP server PUT/POST handling</h3>
<p>The server must ack each blockwise portion of the response body received from the client by writing a Block1 option in the response. See the _sha256_handler() example in <a href="https://github.com/kb2ma/riot-apps/blob/kb2ma-master/gcoap-block-server/gcoap_block.c">gcoap-block-server</a>, which implements the sequence described below.</p>
<ul>
<li>Use <a class="el" href="group__net__nanocoap.html#ga843ab80385da82c6c56a7221dd9ffa68" title="Block1 option getter. ">coap_get_block1()</a> to initialize a block1 struct from the request.</li>
<li>Determine the response code. If the block1 <em>more</em> attribute is 1, use COAP_CODE_CONTINUE to request more responses. Otherwise, use COAP_CODE_CHANGED to indicate a successful transfer.</li>
<li>Use <a class="el" href="group__net__gcoap.html#ga1900ec9205ee6844b422312a0af5896a" title="Initializes a CoAP response packet on a buffer. ">gcoap_resp_init()</a> to begin the response, including the response code.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#gaf529432ec861b1ed971a6ebe392b5136" title="Encode the given block1 option in control use. ">coap_opt_add_block1_control()</a> to write the Block1 option.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> to determine the length of the PDU. If appropriate, use the COAP_OPT_FINISH_PAYLOAD parameter and then write the payload.</li>
</ul>
<h3>CoAP client GET request</h3>
<p>The client requests a specific blockwise payload from the overall body by writing a Block2 option in the request. See _resp_handler() in the <a href="https://github.com/RIOT-OS/RIOT/blob/master/examples/gcoap/gcoap_cli.c">gcoap</a> example in the RIOT distribution, which implements the sequence described below.</p>
<ul>
<li>For the first request, use <a class="el" href="group__net__nanocoap.html#gadabe7197cbe80bf17fea0ecf5ee9bf56" title="Initialize a block struct from content information. ">coap_block_object_init()</a> to initialize a new block1 struct. For subsequent requests, first use <a class="el" href="group__net__nanocoap.html#ga68deff4fe341e495eb8c3449e5118c82" title="Block2 option getter. ">coap_get_block2()</a> to read the Block2 option in the response to the previous request. If the <em>more</em> attribute indicates no more blocks, you are done.<ul>
<li>The gcoap example actually does <em>not</em> include a Block2 option in the original request, but the server response includes a blockwise response with a Block2 option anyway. On the other hand, this example shows how blockwise messaging can be supported in a generic way.</li>
</ul>
</li>
<li>If more blocks are available, use <a class="el" href="group__net__gcoap.html#ga38e727699633c4c12a4a54f87b8d8f66" title="Initializes a CoAP request PDU on a buffer. ">gcoap_req_init()</a> to create a new request.</li>
<li>Increment the <em>blknum</em> attribute in the block1 struct from the previous response to request the next blockwise payload.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#ga14bb5cc27fb33ff8abca2d63484b1f10" title="Insert block2 option into buffer in control usage. ">coap_opt_put_block2_control()</a> to write the Block2 option to the request.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> to determine the length of the PDU.</li>
</ul>
<h3>CoAP client PUT/POST request</h3>
<p>The client pushes a specific blockwise payload from the overall body to the server by writing a Block1 option in the request. See _do_block_post() in the <a href="https://github.com/kb2ma/riot-apps/blob/kb2ma-master/gcoap-block-client/gcoap_block.c">gcoap-block-client</a> example, which implements the sequence described below.</p>
<ul>
<li>For the first request, use <a class="el" href="group__net__nanocoap.html#ga72043847cf561f5f6e926cf4323bbd66" title="Initialize a block slicer struct from content information. ">coap_block_slicer_init()</a> to initialize a <em>slicer</em> struct with the desired block number and block size. For subsequent requests, first read the response from the server to the previous request. If the response code is COAP_CODE_CONTINUE, then increment the last block number sent when initializing the slicer struct for the next request.</li>
<li>Use <a class="el" href="group__net__gcoap.html#ga38e727699633c4c12a4a54f87b8d8f66" title="Initializes a CoAP request PDU on a buffer. ">gcoap_req_init()</a> to initialize the request.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#gaf123a387066d0c2cef1548747c72f990" title="Add block1 option in descriptive use from a slicer object. ">coap_opt_add_block1()</a> to add the Block1 option from the slicer. Use 1 as a default for the <em>more</em> parameter. At this point, we don't know yet if this message will be the last in the block exchange. However, we must add the block option at this location in the message.</li>
<li>Use <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> with COAP_OPT_FINISH_PAYLOAD to write the payload marker.</li>
<li>Add the payload using the <code>coap_blockwise_put_xxx()</code> functions. The slicer knows the current position in the overall body of the response. It writes only the portion of the body specified by the block number and block size in the slicer.</li>
<li>Finally, use <a class="el" href="group__net__nanocoap.html#ga48558960d1ee0284529ee65469ad7185" title="Finish a block1 request. ">coap_block1_finish()</a> to finalize the block option with the proper value for the <em>more</em> parameter.</li>
</ul>
<h2>Proxy Operation</h2>
<p>A <a href="https://tools.ietf.org/html/rfc7252#section-5.7.1">CoAP proxy</a> forwards incoming requests to an origin server, or again to another proxy server.</p>
<h3>Proxy Client Handling</h3>
<p>The current implementation only allows the use of <code>Proxy-Uri</code> to specify the absolute URI for the origin server and resource. A request that includes a <code>Proxy-Uri</code> option must not contain any of the <code>Uri-*</code> options. An example:</p>
<div class="fragment"><div class="line"><span class="comment">// endpoint for the proxy server</span></div><div class="line"> <a class="code" href="struct__sock__tl__ep.html">sock_udp_ep_t</a> *proxy_remote = ...;</div><div class="line"><span class="comment">// absolute URI for the origin server and resource</span></div><div class="line"><span class="keywordtype">char</span> *uri = <span class="stringliteral">&quot;coap://[2001:db8::1]:5683/.well-known/core&quot;</span>;</div><div class="line"></div><div class="line"><a class="code" href="group__net__gcoap.html#ga38e727699633c4c12a4a54f87b8d8f66">gcoap_req_init</a>(&amp;pdu, buf, <a class="code" href="group__net__gcoap__conf.html#ga6e17d0741db5fa6da38b769ecdd4c80d">CONFIG_GCOAP_PDU_BUF_SIZE</a>, COAP_METHOD_GET, NULL);</div><div class="line"><a class="code" href="group__net__nanocoap.html#gabe53a821876c7cbca41eb7df4a109af1">coap_opt_add_proxy_uri</a>(&amp;pdu, uri);</div><div class="line"><span class="keywordtype">unsigned</span> len = <a class="code" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012">coap_opt_finish</a>(&amp;pdu, <a class="code" href="group__net__nanocoap.html#ga88497b423bb62815a4f06345b9bd1e0f">COAP_OPT_FINISH_NONE</a>);</div><div class="line"></div><div class="line"><a class="code" href="group__net__gcoap.html#ga45d25b1deccdf56f6fc6c490510edbe6">gcoap_req_send</a>((uint8_t *) pdu-&gt;hdr, len, proxy_remote, _resp_handler, NULL);</div></div><!-- fragment --><p>See the gcoap example for a sample implementation.</p>
<h3>Proxy Server Handling</h3>
<p>Not implemented yet.</p>
<h2>Implementation Notes</h2>
<h3>Waiting for a response</h3>
<p>We take advantage of RIOT's asynchronous messaging by using an xtimer to wait for a response, so the gcoap thread does not block while waiting. The user is notified via the same callback, whether the message is received or the wait times out. We track the response with an entry in the <code>_coap_state.open_reqs</code> array.</p>
<h2>Implementation Status</h2>
<p>gcoap includes server and client capability. Available features include:</p>
<ul>
<li>Message Type: Supports non-confirmable (NON) messaging. Additionally provides a callback on timeout. Provides piggybacked ACK response to a confirmable (CON) request.</li>
<li>Observe extension: Provides server-side registration and notifications.</li>
<li>Server and Client provide helper functions for writing the response/request. See the CoAP topic in the source documentation for details. See the gcoap example for sample implementations.</li>
<li>Server allows an application to register a 'listener', which includes an array of endpoint paths and function callbacks used to write a response.</li>
<li>Server listens on a port at startup; defaults to 5683.</li>
<li>Client operates asynchronously; sends request and then handles response in a user provided callback.</li>
<li>Client generates token; length defined at compile time.</li>
<li>Options: Supports Content-Format for payload. </li>
</ul>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__net__gcoap__conf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap__conf.html">Gcoap compile configurations</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:gcoap_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gcoap_8h.html">gcoap.h</a></td></tr>
<tr class="memdesc:gcoap_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">gcoap definition <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcoap__link__encoder__ctx__t.html">coap_link_encoder_ctx_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context information required to write a resource link.  <a href="structcoap__link__encoder__ctx__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgcoap__listener.html">gcoap_listener</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A modular collection of resources for a server.  <a href="structgcoap__listener.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgcoap__resend__t.html">gcoap_resend_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extends request memo for resending a confirmable request.  <a href="structgcoap__resend__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgcoap__request__memo.html">gcoap_request_memo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memo to handle a response for a request.  <a href="structgcoap__request__memo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgcoap__observe__memo__t.html">gcoap_observe_memo_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memo for Observe registration and notifications.  <a href="structgcoap__observe__memo__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga2f4f23b08bfc7b5bbc578235b1b3ab0e"><td class="memItemLeft" align="right" valign="top"><a id="ga2f4f23b08bfc7b5bbc578235b1b3ab0e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga2f4f23b08bfc7b5bbc578235b1b3ab0e">GCOAP_TOKENLEN_MAX</a>&#160;&#160;&#160;(8)</td></tr>
<tr class="memdesc:ga2f4f23b08bfc7b5bbc578235b1b3ab0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length in bytes for a token. <br /></td></tr>
<tr class="separator:ga2f4f23b08bfc7b5bbc578235b1b3ab0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga786670f21b2ced965003e06a68846e01"><td class="memItemLeft" align="right" valign="top"><a id="ga786670f21b2ced965003e06a68846e01"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga786670f21b2ced965003e06a68846e01">GCOAP_HEADER_MAXLEN</a>&#160;&#160;&#160;(sizeof(<a class="el" href="structcoap__hdr__t.html">coap_hdr_t</a>) + <a class="el" href="group__net__gcoap.html#ga2f4f23b08bfc7b5bbc578235b1b3ab0e">GCOAP_TOKENLEN_MAX</a>)</td></tr>
<tr class="memdesc:ga786670f21b2ced965003e06a68846e01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length in bytes for a header, including the token. <br /></td></tr>
<tr class="separator:ga786670f21b2ced965003e06a68846e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c1bb0c0f347c809b1bd168fbce65151"><td class="memItemLeft" align="right" valign="top"><a id="ga4c1bb0c0f347c809b1bd168fbce65151"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga4c1bb0c0f347c809b1bd168fbce65151">GCOAP_PAYLOAD_MARKER</a>&#160;&#160;&#160;(0xFF)</td></tr>
<tr class="memdesc:ga4c1bb0c0f347c809b1bd168fbce65151"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marks the boundary between header and payload. <br /></td></tr>
<tr class="separator:ga4c1bb0c0f347c809b1bd168fbce65151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9718f9727abd645f0c99cb58cf32c76f"><td class="memItemLeft" align="right" valign="top"><a id="ga9718f9727abd645f0c99cb58cf32c76f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga9718f9727abd645f0c99cb58cf32c76f">GCOAP_SEND_LIMIT_NON</a>&#160;&#160;&#160;(-1)</td></tr>
<tr class="memdesc:ga9718f9727abd645f0c99cb58cf32c76f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value for send_limit in request memo when non-confirmable type. <br /></td></tr>
<tr class="separator:ga9718f9727abd645f0c99cb58cf32c76f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac16c1ec12feb641443f84f6b555c6555"><td class="memItemLeft" align="right" valign="top"><a id="gac16c1ec12feb641443f84f6b555c6555"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gac16c1ec12feb641443f84f6b555c6555">GCOAP_OBS_TICK_EXPONENT</a>&#160;&#160;&#160;(5)</td></tr>
<tr class="memdesc:gac16c1ec12feb641443f84f6b555c6555"><td class="mdescLeft">&#160;</td><td class="mdescRight">See CONFIG_GCOAP_OBS_VALUE_WIDTH. <br /></td></tr>
<tr class="separator:gac16c1ec12feb641443f84f6b555c6555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69c71c7b9977f3b4a3fa064adb527083"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga69c71c7b9977f3b4a3fa064adb527083">GCOAP_STACK_SIZE</a></td></tr>
<tr class="memdesc:ga69c71c7b9977f3b4a3fa064adb527083"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stack size for module thread.  <a href="#ga69c71c7b9977f3b4a3fa064adb527083">More...</a><br /></td></tr>
<tr class="separator:ga69c71c7b9977f3b4a3fa064adb527083"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga197edc062a2d88fec4bd649cc6999abc"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga197edc062a2d88fec4bd649cc6999abc">gcoap_link_encoder_t</a>) (const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *resource, char *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> maxlen, <a class="el" href="structcoap__link__encoder__ctx__t.html">coap_link_encoder_ctx_t</a> *context)</td></tr>
<tr class="memdesc:ga197edc062a2d88fec4bd649cc6999abc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler function to write a resource link.  <a href="#ga197edc062a2d88fec4bd649cc6999abc">More...</a><br /></td></tr>
<tr class="separator:ga197edc062a2d88fec4bd649cc6999abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d9fa657acdc349dc2d16f97a4eef02e"><td class="memItemLeft" align="right" valign="top"><a id="ga3d9fa657acdc349dc2d16f97a4eef02e"></a>
typedef struct <a class="el" href="structgcoap__listener.html">gcoap_listener</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga3d9fa657acdc349dc2d16f97a4eef02e">gcoap_listener_t</a></td></tr>
<tr class="memdesc:ga3d9fa657acdc349dc2d16f97a4eef02e"><td class="mdescLeft">&#160;</td><td class="mdescRight">A modular collection of resources for a server. <br /></td></tr>
<tr class="separator:ga3d9fa657acdc349dc2d16f97a4eef02e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab3719619577e1617098101d5c96c04e"><td class="memItemLeft" align="right" valign="top"><a id="gaab3719619577e1617098101d5c96c04e"></a>
typedef struct <a class="el" href="structgcoap__request__memo.html">gcoap_request_memo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gaab3719619577e1617098101d5c96c04e">gcoap_request_memo_t</a></td></tr>
<tr class="memdesc:gaab3719619577e1617098101d5c96c04e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward declaration of the request memo type. <br /></td></tr>
<tr class="separator:gaab3719619577e1617098101d5c96c04e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f62887693fa63a7595565e44156806d"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga8f62887693fa63a7595565e44156806d">gcoap_resp_handler_t</a>) (const <a class="el" href="group__net__gcoap.html#gaab3719619577e1617098101d5c96c04e">gcoap_request_memo_t</a> *memo, <a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, const <a class="el" href="group__net__sock__udp.html#gaedc829c7973d7870c1ec078f9ffd45a1">sock_udp_ep_t</a> *remote)</td></tr>
<tr class="memdesc:ga8f62887693fa63a7595565e44156806d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler function for a server response, including the state for the originating request.  <a href="#ga8f62887693fa63a7595565e44156806d">More...</a><br /></td></tr>
<tr class="separator:ga8f62887693fa63a7595565e44156806d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae4fa464865a37f897cfab4d3e679bdb1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="kernel__types_8h.html#a8375139300d7cbf23bd8bd89ddddbe84">kernel_pid_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gae4fa464865a37f897cfab4d3e679bdb1">gcoap_init</a> (void)</td></tr>
<tr class="memdesc:gae4fa464865a37f897cfab4d3e679bdb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the gcoap thread and device.  <a href="#gae4fa464865a37f897cfab4d3e679bdb1">More...</a><br /></td></tr>
<tr class="separator:gae4fa464865a37f897cfab4d3e679bdb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c3b10922136af0308bd70c7bb6f0e52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga1c3b10922136af0308bd70c7bb6f0e52">gcoap_register_listener</a> (<a class="el" href="group__net__gcoap.html#ga3d9fa657acdc349dc2d16f97a4eef02e">gcoap_listener_t</a> *listener)</td></tr>
<tr class="memdesc:ga1c3b10922136af0308bd70c7bb6f0e52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts listening for resource paths.  <a href="#ga1c3b10922136af0308bd70c7bb6f0e52">More...</a><br /></td></tr>
<tr class="separator:ga1c3b10922136af0308bd70c7bb6f0e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga38e727699633c4c12a4a54f87b8d8f66"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga38e727699633c4c12a4a54f87b8d8f66">gcoap_req_init</a> (<a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, uint8_t *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> len, unsigned code, const char *path)</td></tr>
<tr class="memdesc:ga38e727699633c4c12a4a54f87b8d8f66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a CoAP request PDU on a buffer.  <a href="#ga38e727699633c4c12a4a54f87b8d8f66">More...</a><br /></td></tr>
<tr class="separator:ga38e727699633c4c12a4a54f87b8d8f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa39b51493945603cfde6d54a50b843a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gaa39b51493945603cfde6d54a50b843a0">gcoap_finish</a> (<a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> payload_len, unsigned format)</td></tr>
<tr class="memdesc:gaa39b51493945603cfde6d54a50b843a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finishes formatting a CoAP PDU after the payload has been written.  <a href="#gaa39b51493945603cfde6d54a50b843a0">More...</a><br /></td></tr>
<tr class="separator:gaa39b51493945603cfde6d54a50b843a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf635d01732aa7c620271d05949103497"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gaf635d01732aa7c620271d05949103497">gcoap_request</a> (<a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, uint8_t *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> len, unsigned code, char *path)</td></tr>
<tr class="memdesc:gaf635d01732aa7c620271d05949103497"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a complete CoAP request PDU when there is not a payload.  <a href="#gaf635d01732aa7c620271d05949103497">More...</a><br /></td></tr>
<tr class="separator:gaf635d01732aa7c620271d05949103497"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga45d25b1deccdf56f6fc6c490510edbe6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga45d25b1deccdf56f6fc6c490510edbe6">gcoap_req_send</a> (const uint8_t *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> len, const <a class="el" href="group__net__sock__udp.html#gaedc829c7973d7870c1ec078f9ffd45a1">sock_udp_ep_t</a> *remote, <a class="el" href="group__net__gcoap.html#ga8f62887693fa63a7595565e44156806d">gcoap_resp_handler_t</a> resp_handler, void *context)</td></tr>
<tr class="memdesc:ga45d25b1deccdf56f6fc6c490510edbe6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a buffer containing a CoAP request to the provided endpoint.  <a href="#ga45d25b1deccdf56f6fc6c490510edbe6">More...</a><br /></td></tr>
<tr class="separator:ga45d25b1deccdf56f6fc6c490510edbe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1900ec9205ee6844b422312a0af5896a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga1900ec9205ee6844b422312a0af5896a">gcoap_resp_init</a> (<a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, uint8_t *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> len, unsigned code)</td></tr>
<tr class="memdesc:ga1900ec9205ee6844b422312a0af5896a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a CoAP response packet on a buffer.  <a href="#ga1900ec9205ee6844b422312a0af5896a">More...</a><br /></td></tr>
<tr class="separator:ga1900ec9205ee6844b422312a0af5896a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gace6fa0e224d1cd07211e22e3af75f8bd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gace6fa0e224d1cd07211e22e3af75f8bd">gcoap_response</a> (<a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, uint8_t *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> len, unsigned code)</td></tr>
<tr class="memdesc:gace6fa0e224d1cd07211e22e3af75f8bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a complete CoAP response PDU when there is no payload.  <a href="#gace6fa0e224d1cd07211e22e3af75f8bd">More...</a><br /></td></tr>
<tr class="separator:gace6fa0e224d1cd07211e22e3af75f8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3918d03f99a7312946bc28d5fdb7b610"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga3918d03f99a7312946bc28d5fdb7b610">gcoap_obs_init</a> (<a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, uint8_t *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> len, const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *resource)</td></tr>
<tr class="memdesc:ga3918d03f99a7312946bc28d5fdb7b610"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a CoAP Observe notification packet on a buffer, for the observer registered for a resource.  <a href="#ga3918d03f99a7312946bc28d5fdb7b610">More...</a><br /></td></tr>
<tr class="separator:ga3918d03f99a7312946bc28d5fdb7b610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab89faee1f2f999f4d6088ec91ca620bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gab89faee1f2f999f4d6088ec91ca620bd">gcoap_obs_send</a> (const uint8_t *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> len, const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *resource)</td></tr>
<tr class="memdesc:gab89faee1f2f999f4d6088ec91ca620bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a buffer containing a CoAP Observe notification to the observer registered for a resource.  <a href="#gab89faee1f2f999f4d6088ec91ca620bd">More...</a><br /></td></tr>
<tr class="separator:gab89faee1f2f999f4d6088ec91ca620bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef16b142f138806dfa5d1c5a38794ebd"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gaef16b142f138806dfa5d1c5a38794ebd">gcoap_op_state</a> (void)</td></tr>
<tr class="memdesc:gaef16b142f138806dfa5d1c5a38794ebd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides important operational statistics.  <a href="#gaef16b142f138806dfa5d1c5a38794ebd">More...</a><br /></td></tr>
<tr class="separator:gaef16b142f138806dfa5d1c5a38794ebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4be254d6f14972550cb06a1c8aeef056"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga4be254d6f14972550cb06a1c8aeef056">gcoap_get_resource_list</a> (void *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> maxlen, uint8_t cf)</td></tr>
<tr class="memdesc:ga4be254d6f14972550cb06a1c8aeef056"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the resource list, currently only <code>CoRE Link Format</code> (COAP_FORMAT_LINK) supported.  <a href="#ga4be254d6f14972550cb06a1c8aeef056">More...</a><br /></td></tr>
<tr class="separator:ga4be254d6f14972550cb06a1c8aeef056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa097b4388e04ab265cf79cf38c493d07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gaa097b4388e04ab265cf79cf38c493d07">gcoap_encode_link</a> (const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *resource, char *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> maxlen, <a class="el" href="structcoap__link__encoder__ctx__t.html">coap_link_encoder_ctx_t</a> *context)</td></tr>
<tr class="memdesc:gaa097b4388e04ab265cf79cf38c493d07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a resource in CoRE Link Format to a provided buffer.  <a href="#gaa097b4388e04ab265cf79cf38c493d07">More...</a><br /></td></tr>
<tr class="separator:gaa097b4388e04ab265cf79cf38c493d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50a45277d058a807a6e0dfd1de67d707"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga50a45277d058a807a6e0dfd1de67d707">gcoap_add_qstring</a> (<a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, const char *key, const char *val)</td></tr>
<tr class="memdesc:ga50a45277d058a807a6e0dfd1de67d707"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a single Uri-Query option to a CoAP request.  <a href="#ga50a45277d058a807a6e0dfd1de67d707">More...</a><br /></td></tr>
<tr class="separator:ga50a45277d058a807a6e0dfd1de67d707"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
States for the memo used to track waiting for a response</h2></td></tr>
<tr class="memitem:gae67f6e2e4ac7fc4ed2fd92a9e5450b38"><td class="memItemLeft" align="right" valign="top"><a id="gae67f6e2e4ac7fc4ed2fd92a9e5450b38"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gae67f6e2e4ac7fc4ed2fd92a9e5450b38">GCOAP_MEMO_UNUSED</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="memdesc:gae67f6e2e4ac7fc4ed2fd92a9e5450b38"><td class="mdescLeft">&#160;</td><td class="mdescRight">This memo is unused. <br /></td></tr>
<tr class="separator:gae67f6e2e4ac7fc4ed2fd92a9e5450b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c6eedf1d089acf408866a7510741d9b"><td class="memItemLeft" align="right" valign="top"><a id="ga5c6eedf1d089acf408866a7510741d9b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga5c6eedf1d089acf408866a7510741d9b">GCOAP_MEMO_WAIT</a>&#160;&#160;&#160;(1)</td></tr>
<tr class="memdesc:ga5c6eedf1d089acf408866a7510741d9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request sent; awaiting response. <br /></td></tr>
<tr class="separator:ga5c6eedf1d089acf408866a7510741d9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ac030a4adb19a46fcf5ab50722b4365"><td class="memItemLeft" align="right" valign="top"><a id="ga6ac030a4adb19a46fcf5ab50722b4365"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga6ac030a4adb19a46fcf5ab50722b4365">GCOAP_MEMO_RESP</a>&#160;&#160;&#160;(2)</td></tr>
<tr class="memdesc:ga6ac030a4adb19a46fcf5ab50722b4365"><td class="mdescLeft">&#160;</td><td class="mdescRight">Got response. <br /></td></tr>
<tr class="separator:ga6ac030a4adb19a46fcf5ab50722b4365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94c3f5b193a7a264523b6064fb490047"><td class="memItemLeft" align="right" valign="top"><a id="ga94c3f5b193a7a264523b6064fb490047"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga94c3f5b193a7a264523b6064fb490047">GCOAP_MEMO_TIMEOUT</a>&#160;&#160;&#160;(3)</td></tr>
<tr class="memdesc:ga94c3f5b193a7a264523b6064fb490047"><td class="mdescLeft">&#160;</td><td class="mdescRight">Timeout waiting for response. <br /></td></tr>
<tr class="separator:ga94c3f5b193a7a264523b6064fb490047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3033a685118de6cb5e1e629a31b51dbb"><td class="memItemLeft" align="right" valign="top"><a id="ga3033a685118de6cb5e1e629a31b51dbb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga3033a685118de6cb5e1e629a31b51dbb">GCOAP_MEMO_ERR</a>&#160;&#160;&#160;(4)</td></tr>
<tr class="memdesc:ga3033a685118de6cb5e1e629a31b51dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error processing response packet. <br /></td></tr>
<tr class="separator:ga3033a685118de6cb5e1e629a31b51dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
States for the memo used to track Observe registrations</h2></td></tr>
<tr class="memitem:ga4479f5af8a6165713cf47f1fb2d87be5"><td class="memItemLeft" align="right" valign="top"><a id="ga4479f5af8a6165713cf47f1fb2d87be5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga4479f5af8a6165713cf47f1fb2d87be5">GCOAP_OBS_MEMO_UNUSED</a>&#160;&#160;&#160;(0)</td></tr>
<tr class="memdesc:ga4479f5af8a6165713cf47f1fb2d87be5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This memo is unused. <br /></td></tr>
<tr class="separator:ga4479f5af8a6165713cf47f1fb2d87be5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d4212d88dac27b70bc0393c4aca7ac7"><td class="memItemLeft" align="right" valign="top"><a id="ga6d4212d88dac27b70bc0393c4aca7ac7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga6d4212d88dac27b70bc0393c4aca7ac7">GCOAP_OBS_MEMO_IDLE</a>&#160;&#160;&#160;(1)</td></tr>
<tr class="memdesc:ga6d4212d88dac27b70bc0393c4aca7ac7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registration OK; no current activity. <br /></td></tr>
<tr class="separator:ga6d4212d88dac27b70bc0393c4aca7ac7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga784fe0fe1e6233d281bf4493745041ba"><td class="memItemLeft" align="right" valign="top"><a id="ga784fe0fe1e6233d281bf4493745041ba"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#ga784fe0fe1e6233d281bf4493745041ba">GCOAP_OBS_MEMO_PENDING</a>&#160;&#160;&#160;(2)</td></tr>
<tr class="memdesc:ga784fe0fe1e6233d281bf4493745041ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resource changed; notification pending. <br /></td></tr>
<tr class="separator:ga784fe0fe1e6233d281bf4493745041ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Return values for gcoap_obs_init()</h2></td></tr>
<tr class="memitem:ga89e93b03de63c4665ccbfa19df07c543"><td class="memItemLeft" align="right" valign="top"><a id="ga89e93b03de63c4665ccbfa19df07c543"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GCOAP_OBS_INIT_OK</b>&#160;&#160;&#160;(0)</td></tr>
<tr class="separator:ga89e93b03de63c4665ccbfa19df07c543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2cdcf4e08d5779945f2fa98be1a5b443"><td class="memItemLeft" align="right" valign="top"><a id="ga2cdcf4e08d5779945f2fa98be1a5b443"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GCOAP_OBS_INIT_ERR</b>&#160;&#160;&#160;(-1)</td></tr>
<tr class="separator:ga2cdcf4e08d5779945f2fa98be1a5b443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga979fbb551053edfd9a5747951f5b73d3"><td class="memItemLeft" align="right" valign="top"><a id="ga979fbb551053edfd9a5747951f5b73d3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GCOAP_OBS_INIT_UNUSED</b>&#160;&#160;&#160;(-2)</td></tr>
<tr class="separator:ga979fbb551053edfd9a5747951f5b73d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Bitwise positional flags for encoding resource links</h2></td></tr>
<tr class="memitem:gaf417674bbd24b487a00f04b5ba35492d"><td class="memItemLeft" align="right" valign="top"><a id="gaf417674bbd24b487a00f04b5ba35492d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__net__gcoap.html#gaf417674bbd24b487a00f04b5ba35492d">COAP_LINK_FLAG_INIT_RESLIST</a>&#160;&#160;&#160;(1)</td></tr>
<tr class="memdesc:gaf417674bbd24b487a00f04b5ba35492d"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize as for first resource in a list <br /></td></tr>
<tr class="separator:gaf417674bbd24b487a00f04b5ba35492d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga69c71c7b9977f3b4a3fa064adb527083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga69c71c7b9977f3b4a3fa064adb527083">&#9670;&nbsp;</a></span>GCOAP_STACK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GCOAP_STACK_SIZE</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(<a class="code" href="group__core__thread.html#ga713ebddc00581f4d415095cdbfd8791f">THREAD_STACKSIZE_DEFAULT</a> + <a class="code" href="debug_8h.html#a388b22f752e93207731195e90c17dc1d">DEBUG_EXTRA_STACKSIZE</a> \</div><div class="line">                          + <span class="keyword">sizeof</span>(<a class="code" href="structcoap__pkt__t.html">coap_pkt_t</a>))</div><div class="ttc" id="debug_8h_html_a388b22f752e93207731195e90c17dc1d"><div class="ttname"><a href="debug_8h.html#a388b22f752e93207731195e90c17dc1d">DEBUG_EXTRA_STACKSIZE</a></div><div class="ttdeci">#define DEBUG_EXTRA_STACKSIZE</div><div class="ttdoc">Extra stacksize needed when ENABLE_DEBUG==1. </div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00114">debug.h:114</a></div></div>
<div class="ttc" id="group__core__thread_html_ga713ebddc00581f4d415095cdbfd8791f"><div class="ttname"><a href="group__core__thread.html#ga713ebddc00581f4d415095cdbfd8791f">THREAD_STACKSIZE_DEFAULT</a></div><div class="ttdeci">#define THREAD_STACKSIZE_DEFAULT</div><div class="ttdoc">A reasonable default stack size that will suffice most smaller tasks. </div><div class="ttdef"><b>Definition:</b> <a href="core_2include_2thread_8h_source.html#l00195">thread.h:195</a></div></div>
<div class="ttc" id="structcoap__pkt__t_html"><div class="ttname"><a href="structcoap__pkt__t.html">coap_pkt_t</a></div><div class="ttdoc">CoAP PDU parsing context structure. </div><div class="ttdef"><b>Definition:</b> <a href="nanocoap_8h_source.html#l00186">nanocoap.h:186</a></div></div>
</div><!-- fragment -->
<p>Stack size for module thread. </p>

<p class="definition">Definition at line <a class="el" href="gcoap_8h_source.html#l00608">608</a> of file <a class="el" href="gcoap_8h_source.html">gcoap.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga197edc062a2d88fec4bd649cc6999abc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga197edc062a2d88fec4bd649cc6999abc">&#9670;&nbsp;</a></span>gcoap_link_encoder_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a>(* gcoap_link_encoder_t) (const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *resource, char *buf, <a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> maxlen, <a class="el" href="structcoap__link__encoder__ctx__t.html">coap_link_encoder_ctx_t</a> *context)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler function to write a resource link. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">resource</td><td>Resource for link </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>Buffer on which to write; may be null </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxlen</td><td>Remaining length for <code>buf</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>Contextual information on what/how to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>count of bytes written to <code>buf</code> (or writable if <code>buf</code> is null) </dd>
<dd>
-1 on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcoap_8h_source.html#l00650">650</a> of file <a class="el" href="gcoap_8h_source.html">gcoap.h</a>.</p>

</div>
</div>
<a id="ga8f62887693fa63a7595565e44156806d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8f62887693fa63a7595565e44156806d">&#9670;&nbsp;</a></span>gcoap_resp_handler_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* gcoap_resp_handler_t) (const <a class="el" href="group__net__gcoap.html#gaab3719619577e1617098101d5c96c04e">gcoap_request_memo_t</a> *memo, <a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *pdu, const <a class="el" href="group__net__sock__udp.html#gaedc829c7973d7870c1ec078f9ffd45a1">sock_udp_ep_t</a> *remote)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler function for a server response, including the state for the originating request. </p>
<p>If request timed out, the packet header is for the request. </p>

<p class="definition">Definition at line <a class="el" href="gcoap_8h_source.html#l00675">675</a> of file <a class="el" href="gcoap_8h_source.html">gcoap.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga50a45277d058a807a6e0dfd1de67d707"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50a45277d058a807a6e0dfd1de67d707">&#9670;&nbsp;</a></span>gcoap_add_qstring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gcoap_add_qstring </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a single Uri-Query option to a CoAP request. </p>
<p>To add multiple Uri-Query options, simply call this function multiple times. The Uri-Query options will be added in the order those calls.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000016">Deprecated:</a></b></dt><dd>Will not be available after the 2020.10 release. Use <a class="el" href="group__net__nanocoap.html#ga05535cd5dff6273ca1dab93844d73b54" title="Adds a single Uri-Query option in the form &#39;key=value&#39; into pkt. ">coap_opt_add_uri_query()</a> instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pdu</td><td>The package that is being build </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>Key to add to the query string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>Value to assign to <code>key</code> (may be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>((pdu != NULL) &amp;&amp; (key != NULL))</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>overall length of new query string </dd>
<dd>
-1 on error </dd></dl>

</div>
</div>
<a id="gaa097b4388e04ab265cf79cf38c493d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa097b4388e04ab265cf79cf38c493d07">&#9670;&nbsp;</a></span>gcoap_encode_link()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> gcoap_encode_link </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcoap__link__encoder__ctx__t.html">coap_link_encoder_ctx_t</a> *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a resource in CoRE Link Format to a provided buffer. </p>
<p>This default implementation only writes the resource path.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">resource</td><td>resource to write </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>output buffer to write link into, may be null </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxlen</td><td>length of <code>buf</code>, ignored if <code>buf</code> is NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>other parameters that affect how link is written</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>count of bytes written to <code>buf</code> (or writable if <code>buf</code> is null) </dd>
<dd>
-1 on error </dd></dl>

</div>
</div>
<a id="gaa39b51493945603cfde6d54a50b843a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa39b51493945603cfde6d54a50b843a0">&#9670;&nbsp;</a></span>gcoap_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> gcoap_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>payload_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>format</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finishes formatting a CoAP PDU after the payload has been written. </p>
<p>Assumes the PDU has been initialized with a gcoap_xxx_init() function, like <a class="el" href="group__net__gcoap.html#ga38e727699633c4c12a4a54f87b8d8f66" title="Initializes a CoAP request PDU on a buffer. ">gcoap_req_init()</a>.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000015">Deprecated:</a></b></dt><dd>Will not be available after the 2020.07 release. Use <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a> instead.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>To use this function, you only may have added an Option with option number less than COAP_OPT_CONTENT_FORMAT. Otherwise, use the struct-based API described with <a class="el" href="group__net__nanocoap.html">nanocoap. </a> With this API, you specify the format with <a class="el" href="group__net__nanocoap.html#gaea2005a7729753df4c2725e098f12a80" title="Encode the given uint option into pkt. ">coap_opt_add_uint()</a>, prepare for the payload with <a class="el" href="group__net__nanocoap.html#gaf94c66182f7412d256c32c66d1d7a012" title="Finalizes options as required and prepares for payload. ">coap_opt_finish()</a>, and then write the payload.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pdu</td><td>Request metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">payload_len</td><td>Length of the payload, or 0 if none </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">format</td><td>Format code for the payload; use COAP_FORMAT_NONE if not specified</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size of the PDU </dd>
<dd>
&lt; 0 on error </dd></dl>

</div>
</div>
<a id="ga4be254d6f14972550cb06a1c8aeef056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4be254d6f14972550cb06a1c8aeef056">&#9670;&nbsp;</a></span>gcoap_get_resource_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gcoap_get_resource_list </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>cf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the resource list, currently only <code>CoRE Link Format</code> (COAP_FORMAT_LINK) supported. </p>
<p>If <code>buf</code> := NULL, nothing will be written but the size of the resulting resource list is computed and returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>output buffer to write resource list into, my be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxlen</td><td>length of <code>buf</code>, ignored if <code>buf</code> is NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cf</td><td>content format to use for the resource list, currently only COAP_FORMAT_LINK supported</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000039">Todo:</a></b></dt><dd><p class="startdd">add support for <code>JSON CoRE Link Format</code> </p>
<p class="enddd">add support for 'CBOR CoRE Link Format`</p>
</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>the number of bytes written to <code>buf</code> </dd>
<dd>
-1 on error </dd></dl>

</div>
</div>
<a id="gae4fa464865a37f897cfab4d3e679bdb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4fa464865a37f897cfab4d3e679bdb1">&#9670;&nbsp;</a></span>gcoap_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="kernel__types_8h.html#a8375139300d7cbf23bd8bd89ddddbe84">kernel_pid_t</a> gcoap_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the gcoap thread and device. </p>
<p>Must call once before first use.</p>
<dl class="section return"><dt>Returns</dt><dd>PID of the gcoap thread on success. </dd>
<dd>
-EEXIST, if thread already has been created. </dd>
<dd>
-EINVAL, if the IP port already is in use. </dd></dl>

</div>
</div>
<a id="ga3918d03f99a7312946bc28d5fdb7b610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3918d03f99a7312946bc28d5fdb7b610">&#9670;&nbsp;</a></span>gcoap_obs_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gcoap_obs_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a CoAP Observe notification packet on a buffer, for the observer registered for a resource. </p>
<p>First verifies that an observer has been registered for the resource.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pdu</td><td>Notification metadata </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>Buffer containing the PDU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resource</td><td>Resource for the notification</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>GCOAP_OBS_INIT_OK on success </dd>
<dd>
GCOAP_OBS_INIT_ERR on error </dd>
<dd>
GCOAP_OBS_INIT_UNUSED if no observer for resource </dd></dl>

</div>
</div>
<a id="gab89faee1f2f999f4d6088ec91ca620bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab89faee1f2f999f4d6088ec91ca620bd">&#9670;&nbsp;</a></span>gcoap_obs_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> gcoap_obs_send </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcoap__resource__t.html">coap_resource_t</a> *&#160;</td>
          <td class="paramname"><em>resource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a buffer containing a CoAP Observe notification to the observer registered for a resource. </p>
<p>Assumes a single observer for a resource.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Buffer containing the PDU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resource</td><td>Resource to send</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>length of the packet </dd>
<dd>
0 if cannot send </dd></dl>

</div>
</div>
<a id="gaef16b142f138806dfa5d1c5a38794ebd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef16b142f138806dfa5d1c5a38794ebd">&#9670;&nbsp;</a></span>gcoap_op_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gcoap_op_state </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides important operational statistics. </p>
<p>Useful for monitoring.</p>
<dl class="section return"><dt>Returns</dt><dd>count of unanswered requests </dd></dl>

</div>
</div>
<a id="ga1c3b10922136af0308bd70c7bb6f0e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1c3b10922136af0308bd70c7bb6f0e52">&#9670;&nbsp;</a></span>gcoap_register_listener()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gcoap_register_listener </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__net__gcoap.html#ga3d9fa657acdc349dc2d16f97a4eef02e">gcoap_listener_t</a> *&#160;</td>
          <td class="paramname"><em>listener</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts listening for resource paths. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">listener</td><td>Listener containing the resources. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga38e727699633c4c12a4a54f87b8d8f66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga38e727699633c4c12a4a54f87b8d8f66">&#9670;&nbsp;</a></span>gcoap_req_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gcoap_req_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a CoAP request PDU on a buffer. </p>
<p>If <code>code</code> is COAP_CODE_EMPTY, prepares a complete "CoAP ping" 4 byte empty message request, ready to send.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pdu</td><td>Request metadata </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>Buffer containing the PDU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>Request code, one of COAP_METHOD_XXX or COAP_CODE_EMPTY to ping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Resource path, may be NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>path</code> must start with <code>/</code> if not NULL</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
&lt; 0 on error </dd></dl>

</div>
</div>
<a id="ga45d25b1deccdf56f6fc6c490510edbe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga45d25b1deccdf56f6fc6c490510edbe6">&#9670;&nbsp;</a></span>gcoap_req_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a> gcoap_req_send </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__net__sock__udp.html#gaedc829c7973d7870c1ec078f9ffd45a1">sock_udp_ep_t</a> *&#160;</td>
          <td class="paramname"><em>remote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__net__gcoap.html#ga8f62887693fa63a7595565e44156806d">gcoap_resp_handler_t</a>&#160;</td>
          <td class="paramname"><em>resp_handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a buffer containing a CoAP request to the provided endpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Buffer containing the PDU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">remote</td><td>Destination for the packet </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resp_handler</td><td>Callback when response received, may be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>User defined context passed to the response handler</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>length of the packet </dd>
<dd>
0 if cannot send </dd></dl>

</div>
</div>
<a id="gaf635d01732aa7c620271d05949103497"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf635d01732aa7c620271d05949103497">&#9670;&nbsp;</a></span>gcoap_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> gcoap_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes a complete CoAP request PDU when there is not a payload. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pdu</td><td>Request metadata </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">buf</td><td>Buffer containing the PDU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>Request code: GCOAP_[GET|POST|PUT|DELETE] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Resource path, <em>must</em> start with '/'</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size of the PDU within the buffer </dd>
<dd>
&lt; 0 on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcoap_8h_source.html#l00793">793</a> of file <a class="el" href="gcoap_8h_source.html">gcoap.h</a>.</p>

</div>
</div>
<a id="ga1900ec9205ee6844b422312a0af5896a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1900ec9205ee6844b422312a0af5896a">&#9670;&nbsp;</a></span>gcoap_resp_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gcoap_resp_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a CoAP response packet on a buffer. </p>
<p>Initializes payload location within the buffer based on packet setup.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pdu</td><td>Response metadata </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Buffer containing the PDU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>Response code</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
&lt; 0 on error </dd></dl>

</div>
</div>
<a id="gace6fa0e224d1cd07211e22e3af75f8bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gace6fa0e224d1cd07211e22e3af75f8bd">&#9670;&nbsp;</a></span>gcoap_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="msp430__types_8h.html#af02a2e09430a9ed80bedb598467ce8d1">ssize_t</a> gcoap_response </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcoap__pkt__t.html">coap_pkt_t</a> *&#160;</td>
          <td class="paramname"><em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="msp430__types_8h.html#a7c94ea6f8948649f8d181ae55911eeaf">size_t</a>&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes a complete CoAP response PDU when there is no payload. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pdu</td><td>Response metadata </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>Buffer containing the PDU </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>Response code</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size of the PDU within the buffer </dd>
<dd>
&lt; 0 on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcoap_8h_source.html#l00843">843</a> of file <a class="el" href="gcoap_8h_source.html">gcoap.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Wed Jul 1 2020 17:09:00 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>
</html>
