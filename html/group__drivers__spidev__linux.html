<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Linux User Mode SPI Driver</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <!--BEGIN SEARCHENGINE hidden-sm hidden-xs"-->
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right"
                    onsubmit="try{
                        var rhtml=document.getElementById('MSearchResults').contentWindow.document.body.innerHTML;
                        document.getElementById('MSearchResultsWindow').style.display='none';
                        document.getElementById('top').append(document.getElementById('MSearchSelectWindow'));
                        document.getElementById('top').append(document.getElementById('MSearchResultsWindow'));
                        document.getElementById('doc-content').innerHTML=rhtml;
                        }finally{
                            return false;
                    }">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event);
                              var r=document.getElementById('MSearchResultsWindow');
                              if(parseInt(r.style.left)<0)r.style.left=0;
                              var x=document.getElementById('MSearchResults');
                              if(x.scrollWidth>window.screen.width)x.style.width=window.screen.width-2+'px';
                              var f=document.getElementById('riot-searchform');
                              if(parseInt( r.style.top) < f.offsetTop+f.scrollHeight) r.style.top = f.offsetTop+f.scrollHeight+'px';">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__drivers__spidev__linux.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Linux User Mode SPI Driver<div class="ingroups"><a class="el" href="group__cpu.html">CPU</a> &raquo; <a class="el" href="group__cpu__native.html">Native</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of SPI access from Linux User Space.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Implementation of SPI access from Linux User Space. </p>
<p>This module allows to connect a RIOT application that runs on a Linux host to the physical SPI bus(ses) of that host. To do so, the application has to be compiled for the native board in a Linux environment.</p>
<p>SPI support is automatically included if either a module requiring the <code>PERIPH_SPI</code> feature is added to the application or if it is explicitly listed as <code>FEATURES_REQUIRED</code> in the application's Makefile.</p>
<p>At runtime, the process has to be connected to a specific bus on the host machine. SPI buses are exposed as <code>/dev/spidevB.D</code> character files, where B is the Bus ID (MISO, MOSI and SCLK lines) and D denotes the connected device or hardware chip select line. Ideally, this structure should be reflected when mapping the device files to RIOT SPI buses.</p>
<p>Example:</p>
<div class="fragment"><div class="line">$ ./riot_native_app --spi=0:0:/dev/spidev0.0 --spi=0:1:/dev/spidev0.1</div></div><!-- fragment --><p>This will add <code>/dev/spidev0.0</code> and <code>/dev/spidev0.1</code> as <a class="el" href="group__drivers__periph__spi.html#gafb9420809bc7722e41488a090b53eaf9" title="Default SPI device access macro. ">SPI_DEV(0)</a> in RIOT. The first device can be used with <a class="el" href="group__drivers__periph__spi.html#ga292c9a0a5b03329a153ad28343ff2e09" title="Default SPI hardware chip select access macro. ">SPI_HWCS(0)</a> as CS parameter, the second one with <a class="el" href="group__drivers__periph__spi.html#ga292c9a0a5b03329a153ad28343ff2e09" title="Default SPI hardware chip select access macro. ">SPI_HWCS(1)</a> as CS parameter.</p>
<p>Multiple SPI buses can be added by increasing SPI_NUMOF in the Makefile: </p><div class="fragment"><div class="line">CFLAGS += -DSPI_NUMOF=n</div></div><!-- fragment --><p>The sames goes for the SPI_MAXCS parameter that defines the maximum number of SPI_HWCS values per bus.</p>
<p>Buses that aren't assigned during startup will return either SPI_NODEV or SPI_NOCS when accessed.</p>
<p>If the SPI API is called with SPI_CS_UNDEF as CS parameter, the driver will select the file descriptor with the lowest HWCS id for that bus, but the actual CS line will not be pulled low (if the hardware supports this). This would (in principle) allow to control CS manually. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:spidev__linux_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spidev__linux_8h.html">spidev_linux.h</a></td></tr>
<tr class="memdesc:spidev__linux_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of SPI access from Linux User Space. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structspidev__linux__conf.html">spidev_linux_conf</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static runtime configuration for SPI port + CS line.  <a href="structspidev__linux__conf.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structspidev__linux__state.html">spidev_linux_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic runtime state for SPI port + CS line.  <a href="structspidev__linux__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gae7a9e5e23fbf856d9686453164a7f9a5"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structspidev__linux__conf.html">spidev_linux_conf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__spidev__linux.html#gae7a9e5e23fbf856d9686453164a7f9a5">spidev_linux_conf_t</a></td></tr>
<tr class="memdesc:gae7a9e5e23fbf856d9686453164a7f9a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Static runtime configuration for SPI port + CS line.  <a href="#gae7a9e5e23fbf856d9686453164a7f9a5">More...</a><br /></td></tr>
<tr class="separator:gae7a9e5e23fbf856d9686453164a7f9a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacdd490549b04a99b937a353456bfea1a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structspidev__linux__state.html">spidev_linux_state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__spidev__linux.html#gacdd490549b04a99b937a353456bfea1a">spidev_linux_state_t</a></td></tr>
<tr class="memdesc:gacdd490549b04a99b937a353456bfea1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dynamic runtime state for SPI port + CS line.  <a href="#gacdd490549b04a99b937a353456bfea1a">More...</a><br /></td></tr>
<tr class="separator:gacdd490549b04a99b937a353456bfea1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga3babbf89cae9b856a12864a41506efbd"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="group__drivers__spidev__linux.html#gga3babbf89cae9b856a12864a41506efbdabfa9f9acdeba5f673bc664da98e7d677">SPI_SETUP_OK</a> = 0, 
<a class="el" href="group__drivers__spidev__linux.html#gga3babbf89cae9b856a12864a41506efbda501f0624d9cea43efc8b9bdd9b450dd7">SPI_SETUP_INVALID</a> = -1
 }<tr class="memdesc:ga3babbf89cae9b856a12864a41506efbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Status codes for SPI device setup.  <a href="group__drivers__spidev__linux.html#ga3babbf89cae9b856a12864a41506efbd">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ga3babbf89cae9b856a12864a41506efbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaec14114e64dfafd939b5e0d7ccdf97a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__spidev__linux.html#gaec14114e64dfafd939b5e0d7ccdf97a3">spidev_linux_setup</a> (<a class="el" href="group__drivers__periph__spi.html#gac33db64063315b2b98b535051813ccea">spi_t</a> bus, <a class="el" href="group__drivers__periph__spi.html#gaf5fbaf43946646c588c9372e8906c99e">spi_cs_t</a> cs, const char *name)</td></tr>
<tr class="memdesc:gaec14114e64dfafd939b5e0d7ccdf97a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">register <code>/dev/spidev*</code> device to be used for SPI  <a href="#gaec14114e64dfafd939b5e0d7ccdf97a3">More...</a><br /></td></tr>
<tr class="separator:gaec14114e64dfafd939b5e0d7ccdf97a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0457480f81ce4289acaef62a1449a68"><td class="memItemLeft" align="right" valign="top"><a id="gac0457480f81ce4289acaef62a1449a68"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__drivers__spidev__linux.html#gac0457480f81ce4289acaef62a1449a68">spidev_linux_teardown</a> (void)</td></tr>
<tr class="memdesc:gac0457480f81ce4289acaef62a1449a68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close open SPI file descriptors. <br /></td></tr>
<tr class="separator:gac0457480f81ce4289acaef62a1449a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gae7a9e5e23fbf856d9686453164a7f9a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae7a9e5e23fbf856d9686453164a7f9a5">&#9670;&nbsp;</a></span>spidev_linux_conf_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structspidev__linux__conf.html">spidev_linux_conf</a>  <a class="el" href="group__drivers__spidev__linux.html#gae7a9e5e23fbf856d9686453164a7f9a5">spidev_linux_conf_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Static runtime configuration for SPI port + CS line. </p>
<p>Contains the information that is passed by command line on startup </p>

</div>
</div>
<a id="gacdd490549b04a99b937a353456bfea1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacdd490549b04a99b937a353456bfea1a">&#9670;&nbsp;</a></span>spidev_linux_state_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structspidev__linux__state.html">spidev_linux_state</a>  <a class="el" href="group__drivers__spidev__linux.html#gacdd490549b04a99b937a353456bfea1a">spidev_linux_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dynamic runtime state for SPI port + CS line. </p>
<p>Contains state of the line (whether if it's opened, in use, available, ...) </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga3babbf89cae9b856a12864a41506efbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3babbf89cae9b856a12864a41506efbd">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Status codes for SPI device setup. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga3babbf89cae9b856a12864a41506efbdabfa9f9acdeba5f673bc664da98e7d677"></a>SPI_SETUP_OK&#160;</td><td class="fielddoc"><p>parameters are sound </p>
</td></tr>
<tr><td class="fieldname"><a id="gga3babbf89cae9b856a12864a41506efbda501f0624d9cea43efc8b9bdd9b450dd7"></a>SPI_SETUP_INVALID&#160;</td><td class="fielddoc"><p>invalid params or duplicate definition </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="spidev__linux_8h_source.html#l00079">79</a> of file <a class="el" href="spidev__linux_8h_source.html">spidev_linux.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaec14114e64dfafd939b5e0d7ccdf97a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaec14114e64dfafd939b5e0d7ccdf97a3">&#9670;&nbsp;</a></span>spidev_linux_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spidev_linux_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__drivers__periph__spi.html#gac33db64063315b2b98b535051813ccea">spi_t</a>&#160;</td>
          <td class="paramname"><em>bus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__drivers__periph__spi.html#gaf5fbaf43946646c588c9372e8906c99e">spi_cs_t</a>&#160;</td>
          <td class="paramname"><em>cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>register <code>/dev/spidev*</code> device to be used for SPI </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bus</td><td>SPI bus id of the device </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cs</td><td>CS line to configure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>path name for <code>/dev/spidev*</code> device </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SPI_SETUP_OK On success </dd>
<dd>
SPI_SETUP_INVALID On invalid parameters </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Thu Jul 2 2020 15:49:28 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>
</html>
