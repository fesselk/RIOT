<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Atmel SAM R21 Xplained Pro</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
        <script>
            function displaySR(){
            var rhtml=(document.getElementById('MSearchResults').contentWindow.document.body.innerHTML).replace(/href=\"\.\.\//g,'href="');
            document.getElementById('MSearchResultsWindow').style.display='none';
            document.getElementById('top').append(document.getElementById('MSearchSelectWindow'));
            document.getElementById('top').append(document.getElementById('MSearchResultsWindow'));
            document.getElementById('doc-content').innerHTML=rhtml;
            }
        </script>
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <!--BEGIN SEARCHENGINE hidden-sm hidden-xs"-->
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right"
                    onsubmit="try{
                        displaySR();
                    }finally{
                            return false;
                    }">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event);
                              var r=document.getElementById('MSearchResultsWindow');
                              if(parseInt(r.style.left)<0)r.style.left=0;
                              var x=document.getElementById('MSearchResults');
                              if(x.scrollWidth>window.screen.width)x.style.width=window.screen.width-2+'px';
                              var f=document.getElementById('riot-searchform');
                              if(parseInt( r.style.top) < f.offsetTop+f.scrollHeight) r.style.top = f.offsetTop+f.scrollHeight+'px';">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__boards__samr21-xpro.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">Atmel SAM R21 Xplained Pro<div class="ingroups"><a class="el" href="group__boards.html">Boards</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Support for the Atmel SAM R21 Xplained Pro board.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Support for the Atmel SAM R21 Xplained Pro board. </p>
<h2>Overview</h2>
<p>The <code>SAMR21 Xplained Pro</code> is a compact evaluation board by Atmel featuring a ATSAMR21G18A SoC. The SoC includes a SAMD21 ARM Cortex-M0+ micro-controller bundled with Atmel's AT86RF233, a 2.4GHz IEEE802.15.4 compatible radio. For programming the MCU comes with 32Kb of RAM and 256Kb of flash memory.</p>
<p>The samr21-xpro is available from various hardware vendors for ~40EUR (as of sep. 2014).</p>
<h2>Hardware</h2>
<div class="image">
<img src="http://t3.gstatic.com/images?q=tbn:ANd9GcTdbgRUFLgLPWSYq6p26mR7wwikHnO4_vcEwRhwNZqmIHGUwVws3h2nfQ" alt="samr21-xpro image"/>
</div>
<h3>MCU</h3>
<table class="doxtable">
<tr>
<th align="left">MCU </th><th align="left">ATSAMR21G18A  </th></tr>
<tr>
<td align="left">Family </td><td align="left">ARM Cortex-M0+ </td></tr>
<tr>
<td align="left">Vendor </td><td align="left">Atmel </td></tr>
<tr>
<td align="left">RAM </td><td align="left">32Kb </td></tr>
<tr>
<td align="left">Flash </td><td align="left">256Kb </td></tr>
<tr>
<td align="left">Frequency </td><td align="left">up to 48MHz </td></tr>
<tr>
<td align="left">FPU </td><td align="left">no </td></tr>
<tr>
<td align="left">Timers </td><td align="left">6 (1x 16-bit, 2x 24-bit, 3x 32-bit) </td></tr>
<tr>
<td align="left">ADCs </td><td align="left">1x 12-bit (8 channels) </td></tr>
<tr>
<td align="left">UARTs </td><td align="left">max 5 (shared with SPI and I2C) </td></tr>
<tr>
<td align="left">SPIs </td><td align="left">max 5 (see UART) </td></tr>
<tr>
<td align="left">I2Cs </td><td align="left">max 5 (see UART) </td></tr>
<tr>
<td align="left">Vcc </td><td align="left">1.8V - 3.6V </td></tr>
<tr>
<td align="left">Datasheet </td><td align="left"><a href="http://www.atmel.com/Images/Atmel-42223-SAM-R21_Datasheet.pdf">Datasheet</a> </td></tr>
<tr>
<td align="left">Board Manual </td><td align="left"><a href="http://www.atmel.com/Images/Atmel-42243-SAMR21-Xplained-Pro_User-Guide.pdf">Board Manual</a> </td></tr>
</table>
<h3>User Interface</h3>
<p>1 User button and 1 LED:</p>
<table class="doxtable">
<tr>
<th align="left">Device </th><th align="left">PIN  </th></tr>
<tr>
<td align="left">LED0 </td><td align="left">PA19 </td></tr>
<tr>
<td align="left">SW0 (button) </td><td align="left">PA28 </td></tr>
</table>
<h3>Radio</h3>
<p>The SAMR21 SoC includes an on-chip AT86RF233 radio. It is internally connected via SPI and some GPIO pins and behaves in exact the same way as externally connected SPI devices.</p>
<table class="doxtable">
<tr>
<th align="left">Sensor </th><th align="left">AT86RF233  </th></tr>
<tr>
<td align="left">Type </td><td align="left">2.4GHz IEEE802.15.4 radio </td></tr>
<tr>
<td align="left">Vendor </td><td align="left">Atmel </td></tr>
<tr>
<td align="left">Datasheet </td><td align="left"><a href="http://www.atmel.com/images/atmel-8351-mcu_wireless-at86rf233_datasheet.pdf">Datasheet</a> </td></tr>
<tr>
<td align="left">Connected to </td><td align="left">SPI_0 </td></tr>
<tr>
<td align="left">Pin Config: </td><td align="left"></td></tr>
<tr>
<td align="left">Device </td><td align="left">SERCOM4 </td></tr>
<tr>
<td align="left">MOSI </td><td align="left">PB30 (OUT, SPI mosi) </td></tr>
<tr>
<td align="left">MISO </td><td align="left">PC19 (IN, SPI miso) </td></tr>
<tr>
<td align="left">SCLK </td><td align="left">PC18 (OUT, SPI sclk) </td></tr>
<tr>
<td align="left">CS </td><td align="left">PB31 (OUT, GPIO output) </td></tr>
<tr>
<td align="left">IRQ </td><td align="left">PB00 (IN, GPIO external interrupt) </td></tr>
<tr>
<td align="left">RSTN </td><td align="left">PB15 (OUT, GPIO output) </td></tr>
<tr>
<td align="left">SLP_TR </td><td align="left">PA20 (OUT, GPIO output) </td></tr>
</table>
<h2>Implementation Status</h2>
<p>Please refer to <a href="https://github.com/RIOT-OS/RIOT/issues/1646">this tracker</a> to see which projects are work in progress and who is the contact person for this.</p>
<table class="doxtable">
<tr>
<th align="left">Device </th><th align="left">ID </th><th align="left">Supported </th><th align="left">Comments  </th></tr>
<tr>
<td align="left">MCU </td><td align="left">samd21 </td><td align="left">partly </td><td align="left">Energy saving modes not fully utilized </td></tr>
<tr>
<td align="left">Low-level driver </td><td align="left">GPIO </td><td align="left">yes </td><td align="left"></td></tr>
<tr>
<td align="left"></td><td align="left">PWM </td><td align="left">yes </td><td align="left"></td></tr>
<tr>
<td align="left"></td><td align="left">UART </td><td align="left">yes </td><td align="left">two UARTs by now </td></tr>
<tr>
<td align="left"></td><td align="left">I2C </td><td align="left">yes </td><td align="left"></td></tr>
<tr>
<td align="left"></td><td align="left">SPI </td><td align="left">yes </td><td align="left"></td></tr>
<tr>
<td align="left"></td><td align="left">ADC </td><td align="left">yes </td><td align="left">PA04 &amp; PA05 disabled by default due to EDBG's use of them for UART, can be enabled from <code>periph_conf.h</code> </td></tr>
<tr>
<td align="left"></td><td align="left">USB </td><td align="left">no </td><td align="left"></td></tr>
<tr>
<td align="left"></td><td align="left">RTT </td><td align="left">yes </td><td align="left"></td></tr>
<tr>
<td align="left"></td><td align="left">RTC </td><td align="left">yes </td><td align="left"></td></tr>
<tr>
<td align="left"></td><td align="left">RNG </td><td align="left">no </td><td align="left">no HW module </td></tr>
<tr>
<td align="left"></td><td align="left">Timer </td><td align="left">yes </td><td align="left"></td></tr>
<tr>
<td align="left">Radio Chip </td><td align="left">AT86RF233 </td><td align="left">yes </td><td align="left">using at86rf231 driver (this will be renamed to at86rf2xx) </td></tr>
</table>
<h2>Flashing the device</h2>
<p>Connect the device to your Micro-USB cable using the port labeled as <em>EDBG</em>.</p>
<p>The standard method for flashing RIOT to the samr21-xpro is using OpenOCD. For this to work properly, <b>you have to make sure to use a very recent version of OpenOCD</b>. The v0.8.0 release will <em>not</em> work. If this is still the current release you'll have to build OpenOCD from source.</p>
<p>Refer to <a href="https://github.com/RIOT-OS/RIOT/wiki/OpenOCD">https://github.com/RIOT-OS/RIOT/wiki/OpenOCD</a> for building OpenOCD and make sure "cmsis-dap" and "hidapi-libusb" are enabled.</p>
<p>On Linux you will have to add a <b>udev</b> rule for hidraw, like </p><div class="fragment"><div class="line">bash</div><div class="line">echo <span class="stringliteral">&#39;KERNEL==&quot;hidraw*&quot;, SUBSYSTEM==&quot;hidraw&quot;, MODE=&quot;0664&quot;, GROUP=&quot;plugdev&quot;&#39;</span> \</div><div class="line">    | sudo tee -a /etc/udev/rules.d/99-usb.rules</div><div class="line">sudo service udev restart</div></div><!-- fragment --><h3>Arch Linux</h3>
<p>With yaourt: </p><div class="fragment"><div class="line">yaourt -S hidapi-git</div><div class="line">yaourt -S openocd-git</div><div class="line"><span class="preprocessor"># edit PKGBUILD, make sure &quot;hidapi-libusb&quot; is in &quot;_features&quot;</span></div></div><!-- fragment --><p>The <b>udev</b> rules for Arch differ a little from the example given above: </p><div class="fragment"><div class="line">bash</div><div class="line">echo <span class="stringliteral">&#39;KERNEL==&quot;hidraw*&quot;, SUBSYSTEM==&quot;hidraw&quot;, MODE=&quot;0664&quot;, GROUP=&quot;uucp&quot;&#39;</span> \</div><div class="line">    | sudo tee -a /etc/udev/rules.d/99-usb.rules</div><div class="line">sudo udevadm control --reload</div></div><!-- fragment --><h3>Ubuntu</h3>
<p>See <a href="http://watr.li/samr21-dev-setup-ubuntu.html">http://watr.li/samr21-dev-setup-ubuntu.html</a></p>
<h2>Connecting multiple boards</h2>
<p>If you have multiple boards connected to the same computer and want to flash, this is what you can do:</p>
<p>First, run <code>make list-ttys</code>. This will show you a list of currently connected boards, their serial numbers and the names of their TTYs: </p><pre class="fragment">Atmel Corp. EDBG CMSIS-DAP serial: 'ATML2127031800002124', tty(s):
</pre><p> ttyACM0 Atmel Corp. EDBG CMSIS-DAP serial: 'ATML2127031800002145', tty(s): ttyACM1</p>
<p>knowing your serial number, you can flash, open a terminal or debug a specific board like this: </p><pre class="fragment">BOARD=samr21-xpro SERIAL="ATML2127031800002124" make flash
BOARD=samr21-xpro SERIAL="ATML2127031800002124" make term
BOARD=samr21-xpro SERIAL="ATML2127031800002124" make debug
</pre><h2>Accessing STDIO via UART</h2>
<p>STDIO is available through the edbg debugger.</p>
<p>Use the <code>term</code> target to open a terminal: </p><pre class="fragment">make BOARD=samr21-xpro -C examples/hello-world term
</pre><p>RTS / CTS hardware flow control is available on <code><a class="el" href="group__drivers__periph__uart.html#gafc5afd63560d27731d2517b3005f3294" title="Default UART device access macro. ">UART_DEV(0)</a></code> and <code><a class="el" href="group__drivers__periph__uart.html#gafc5afd63560d27731d2517b3005f3294" title="Default UART device access macro. ">UART_DEV(1)</a></code>. This is unavailable when using STDIO directly through the debugger since it does not support it. Therefore to use hardware flow control an external FTDI device must be connected to the board's rx, tx, cts &amp; rts matching pin headers, eg. for <code><a class="el" href="group__drivers__periph__uart.html#gafc5afd63560d27731d2517b3005f3294" title="Default UART device access macro. ">UART_DEV(0)</a></code> to <code>PA5</code>, <code>PA4</code>, <code>PA6</code> &amp; <code>PA7</code> (respectively) on EXT1 headers.</p>
<h2>Supported Toolchains</h2>
<p>For using the samr21-xpro board we strongly recommend the usage of the <a href="https://launchpad.net/gcc-arm-embedded">GNU Tools for ARM Embedded Processors</a> toolchain.</p>
<h2>Known Issues / Problems</h2>
<h3>I2C</h3>
<p>When connecting an I2C device and a logic analyzer to an I2C port at the same time, the internal pull-up resistors are not sufficient for stable bus operation. You probably have to connect external pull-ups to both bus lines. 10K is a good value to start with.</p>
<h3>Stack sizes</h3>
<p>The default stack sizes have not been tuned properly yet. If in doubt why your application crashes try increasing the default stack sizes and use <code>ps</code> to find out how much stack is being used. Tracked in <a href="https://github.com/RIOT-OS/RIOT/issues/2228">https://github.com/RIOT-OS/RIOT/issues/2228</a></p>
<h3>User Button</h3>
<p>When using the SW0 user button as interrupt source it appears that this is triggered when just tipping on the button and not really pressing it.</p>
<h3>Not flashable by OpenOCD anymore</h3>
<p>It can happen that OpenOCD is not able to program the board, because of wrong clock configuration or low power modes. In this case you can use <a href="https://github.com/ataradov/edbg">this little tool</a> to erase the flash. Just follow the instructions to build it and run <code>./edbg -e</code> to erase the flash. Then press the reset button and you're able to program via OpenOCD again.</p>
<h3>Flashing might not work in Virtual Box with Mac OS X as host</h3>
<p>It might happen that flashing through OpenOCD works once inside Virtual Box. But when you try to flash again, you could get a CMSIS-DAP related error. It seems to only happen with USB 3.0 ports. You can take a look at <a href="http://en.wikipedia.org/wiki/Vagrant_%28software%29">Vagrant</a> and use a virtual Linux to run the virtual RIOT, and flash from OS X. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:samr21-xpro_2include_2board_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="samr21-xpro_2include_2board_8h.html">board.h</a></td></tr>
<tr class="memdesc:samr21-xpro_2include_2board_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific definitions for the Atmel SAM R21 Xplained Pro board. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:samr21-xpro_2include_2gpio__params_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="samr21-xpro_2include_2gpio__params_8h.html">gpio_params.h</a></td></tr>
<tr class="memdesc:samr21-xpro_2include_2gpio__params_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific configuration of direct mapped GPIOs. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:boards_2samr21-xpro_2include_2periph__conf_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boards_2samr21-xpro_2include_2periph__conf_8h.html">periph_conf.h</a></td></tr>
<tr class="memdesc:boards_2samr21-xpro_2include_2periph__conf_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration of CPU peripherals for the Atmel SAM R21 Xplained Pro board. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Fri Jul 3 2020 13:27:54 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>
</html>
