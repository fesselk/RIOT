<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>IKEA TRÅDFRI modules</title>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="jquery.min.js"></script>
    <script src="jquery.powertip.min.js"></script>
    <script src="jquery-ui.min.js"></script>
    <script src="doxy-jquery.js"></script>
    <script src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <!-- Bootstrap -->
    <link href="doxygen.css" rel="stylesheet">
    <link href="fonts.css" rel="stylesheet">
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <link href="riot.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div id="top">
        <nav class="navbar navbar-inverse">
          <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" id="brand-logo" href="http://riot-os.org"><img height="40px" src="riot-logo.svg" /></a>
              <p class="navbar-text text-center visible-xs">Documentation</p>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
              <p class="navbar-text navbar-left"><span id="projectbrief">The friendly Operating System for the Internet of Things</span></p>
              <ul id="riot-navlist" class="nav navbar-nav"></ul>
              <!--BEGIN SEARCHENGINE hidden-sm hidden-xs"-->
              <form id="riot-searchform" class="navbar-form navbar-left navbar-right"
                    onsubmit="try{
                        var rhtml=document.getElementById('MSearchResults').contentWindow.document.body.innerHTML;
                        document.getElementById('MSearchResultsWindow').style.display='none';
                        document.getElementById('top').append(document.getElementById('MSearchSelectWindow'));
                        document.getElementById('top').append(document.getElementById('MSearchResultsWindow'));
                        document.getElementById('doc-content').innerHTML=rhtml;
                        }finally{
                            return false;
                    }">
                 <div class="form-group">
                   <div id="MSearchBox" class="MSearchBoxActive">
                     <div class="input-group">
                       <div class="input-group-addon">
                         <span id="MSearchSelect" class="glyphicon glyphicon-search" aria-hidden="true" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"></span>
                       </div>
                       <input class="form-control" type="text" id="MSearchField" placeholder="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event);
                              var r=document.getElementById('MSearchResultsWindow');
                              if(parseInt(r.style.left)<0)r.style.left=0;
                              var x=document.getElementById('MSearchResults');
                              if(x.scrollWidth>window.screen.width)x.style.width=window.screen.width-2+'px';
                              var f=document.getElementById('riot-searchform');
                              if(parseInt( r.style.top) < f.offsetTop+f.scrollHeight) r.style.top = f.offsetTop+f.scrollHeight+'px';">
                       <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()">
                         <span id="search-reset" class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
                       </a>
                     </div>
                   </div>
                 </div>
              </form>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container-fluid -->
        </nav>
      </div>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__boards__ikea-tradfri.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">IKEA TRÅDFRI modules<div class="ingroups"><a class="el" href="group__boards.html">Boards</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Support for the IKEA TRÅDFRI modules.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Support for the IKEA TRÅDFRI modules. </p>
<h2>Overview</h2>
<p>The IKEA TRÅDFRI is a small board found in different IKEA TRÅDFRI products. The board contains an EFR32 microcontroller and a 2MBit SPI NOR Flash.</p>
<p>More information about the module can be found on this <a href="https://github.com/basilfx/TRADFRI-Hacking">GitHub page</a>.</p>
<h2>Hardware</h2>
<h2></h2>
<table class="doxtable">
<tr>
<th>MCU </th><th>EFR32MG1P132F256GM32  </th></tr>
<tr>
<td>Family </td><td>ARM Cortex-M4F </td></tr>
<tr>
<td>Vendor </td><td>Silicon Labs </td></tr>
<tr>
<td>Vendor Family </td><td>EFR32 Mighty Gecko 1P </td></tr>
<tr>
<td>RAM </td><td>32.0KiB (1.0KiB reserved) </td></tr>
<tr>
<td>Flash </td><td>256.0KiB </td></tr>
<tr>
<td>EEPROM </td><td>no </td></tr>
<tr>
<td>Frequency </td><td>up to 38.4 MHz </td></tr>
<tr>
<td>FPU </td><td>yes </td></tr>
<tr>
<td>MPU </td><td>yes </td></tr>
<tr>
<td>DMA </td><td>12 channels </td></tr>
<tr>
<td>Timers </td><td>2x 16-bit + 1x 16-bit (low power) </td></tr>
<tr>
<td>ADCs </td><td>12-bit ADC </td></tr>
<tr>
<td>UARTs </td><td>2x USART, 1x LEUART </td></tr>
<tr>
<td>SPIs </td><td>2x USART </td></tr>
<tr>
<td>I2Cs </td><td>1x </td></tr>
<tr>
<td>Vcc </td><td>1.85V - 3.8V </td></tr>
<tr>
<td>Datasheet </td><td><a href="https://www.silabs.com/documents/public/data-sheets/efr32mg1-datasheet.pdf">Datasheet</a> </td></tr>
<tr>
<td>Manual </td><td><a href="https://www.silabs.com/documents/public/reference-manuals/efr32xg1-rm.pdf">Manual</a> </td></tr>
</table>
<h3>Module versions</h3>
<p>There are currently two types of modules available. The older module is labeled ICC-1 and the newer one ICC-A-1. The main difference, is that pin PF3 is now used to enable the SPI NOR Flash, and not exposed anymore.</p>
<h3>Pinout</h3>
<p>Pin 1 is on the top-left side with only 6 contacts.</p>
<table class="doxtable">
<tr>
<th></th><th>PIN </th><th>PIN </th><th></th></tr>
<tr>
<td></td><td></td><td>16 </td><td>RES </td></tr>
<tr>
<td></td><td></td><td>15 </td><td>PF3 </td></tr>
<tr>
<td>PA0 </td><td>1 </td><td>14 </td><td>PF2 </td></tr>
<tr>
<td>PA1 </td><td>2 </td><td>13 </td><td>PF1 </td></tr>
<tr>
<td>PB12 </td><td>3 </td><td>12 </td><td>PF0 </td></tr>
<tr>
<td>PB13 </td><td>4 </td><td>11 </td><td>PC11 </td></tr>
<tr>
<td>GND </td><td>5 </td><td>10 </td><td>PC10 </td></tr>
<tr>
<td>3V3 </td><td>6 </td><td>9 </td><td>PB14 </td></tr>
<tr>
<td></td><td></td><td>8 </td><td>PB15 </td></tr>
<tr>
<td></td><td></td><td>7 </td><td>GND </td></tr>
</table>
<p>Note**: On the ICC-A-1 module, PF3 is not exposed anymore.</p>
<h3>Peripheral mapping</h3>
<table class="doxtable">
<tr>
<th>Peripheral </th><th>Number </th><th>Hardware </th><th>Pins </th><th>Comments  </th></tr>
<tr>
<td>ADC </td><td>0 </td><td>ADC0 </td><td>CHAN0: internal temperature </td><td>Ports are fixed, 14/16-bit resolution not supported </td></tr>
<tr>
<td>HWCRYPTO </td><td>&mdash; </td><td>&mdash; </td><td></td><td>AES128/AES256, SHA1, SHA256 </td></tr>
<tr>
<td>RTT </td><td>&mdash; </td><td>RTCC </td><td></td><td>1 Hz interval. Either RTT or RTC (see below) </td></tr>
<tr>
<td>RTC </td><td>&mdash; </td><td>RTCC </td><td></td><td>1 Hz interval. Either RTC or RTT (see below) </td></tr>
<tr>
<td>SPI </td><td>0 </td><td>USART1 </td><td>MOSI: PD15, MISO: PD14, CLK: PD13 </td><td></td></tr>
<tr>
<td>Timer </td><td>0 </td><td>TIMER0 + TIMER1 </td><td></td><td>TIMER0 is used as prescaler (must be adjecent) </td></tr>
<tr>
<td>UART </td><td>0 </td><td>USART0 </td><td>RX: PB15, TX: PB14 </td><td>Default STDIO output </td></tr>
<tr>
<td>LEUART </td><td>0 </td><td>LEUART0 </td><td>RX: PB15, TX: PB14 </td><td>Alternate to using UART </td></tr>
</table>
<h3>User interface</h3>
<table class="doxtable">
<tr>
<th>Peripheral </th><th>Mapped to </th><th>Pin </th><th>Comments  </th></tr>
<tr>
<td>LED </td><td>LED0 </td><td>PB13 </td><td></td></tr>
<tr>
<td></td><td>LED1 </td><td>PA1 </td><td></td></tr>
</table>
<h2>Implementation Status</h2>
<table class="doxtable">
<tr>
<th>Device </th><th>ID </th><th>Supported </th><th>Comments  </th></tr>
<tr>
<td>MCU </td><td>EFR32MG1P </td><td>yes </td><td>Power modes supported </td></tr>
<tr>
<td>Low-level driver </td><td>ADC </td><td>yes </td><td></td></tr>
<tr>
<td></td><td>Flash </td><td>yes </td><td></td></tr>
<tr>
<td></td><td>GPIO </td><td>yes </td><td>Interrupts are shared across pins (see reference manual) </td></tr>
<tr>
<td></td><td>HW Crypto </td><td>yes </td><td></td></tr>
<tr>
<td></td><td>I2C </td><td>yes </td><td></td></tr>
<tr>
<td></td><td>PWM </td><td>yes </td><td></td></tr>
<tr>
<td></td><td>RTCC </td><td>yes </td><td>As RTT or RTC </td></tr>
<tr>
<td></td><td>SPI </td><td>partially </td><td>Only master mode </td></tr>
<tr>
<td></td><td>Timer </td><td>yes </td><td></td></tr>
<tr>
<td></td><td>UART </td><td>yes </td><td>USART is shared with SPI. LEUART baud rate limited (see below) </td></tr>
<tr>
<td>SPI NOR Flash </td><td>IS25LQ020B </td><td>yes </td><td>2MBit flash. Can be used with the the MTD API. </td></tr>
</table>
<h2>Board configuration</h2>
<h3>UART selection</h3>
<p>By default the UART peripheral is used for the TX/RX pins, however the pinout is compatible with LEUART also. You can switch from UART to LEUART by compiling with <code>EFM32_USE_LEUART=1</code>.</p>
<p>Note**: LEUART is not working on the ICC-1 module.</p>
<h3>Clock selection</h3>
<p>There are several clock sources that are available for the different peripherals. You are advised to read <a href="https://www.silabs.com/documents/public/application-notes/an0004.1-efm32-cmu.pdf">AN0004.1</a> to get familiar with the different clocks.</p>
<table class="doxtable">
<tr>
<th>Source </th><th>Internal </th><th>Speed </th><th>Comments  </th></tr>
<tr>
<td>HFRCO </td><td>Yes </td><td>19 MHz </td><td>Enabled during startup, changeable </td></tr>
<tr>
<td>HFXO </td><td>No </td><td>38.4 MHz </td><td></td></tr>
<tr>
<td>LFRCO </td><td>Yes </td><td>32.768 kHz </td><td></td></tr>
<tr>
<td>ULFRCO </td><td>No </td><td>1.000 kHz </td><td>Not very reliable as a time source </td></tr>
</table>
<p>The sources can be used to clock following branches:</p>
<table class="doxtable">
<tr>
<th>Branch </th><th>Sources </th><th>Comments  </th></tr>
<tr>
<td>HF </td><td>HFRCO, HFXO </td><td>Core, peripherals </td></tr>
<tr>
<td>LFA </td><td>LFRCO, LFXO </td><td>Low-power timers </td></tr>
<tr>
<td>LFB </td><td>LFRCO, LFXO, CORELEDIV2 </td><td>Low-power UART </td></tr>
<tr>
<td>LFE </td><td>LFRCO, LFXO </td><td>Real-time Clock and Calendar </td></tr>
</table>
<p>CORELEDIV2 is a source that depends on the clock source that powers the core. It is divided by 2 or 4 to not exceed maximum clock frequencies (EMLIB takes care of this).</p>
<p>The frequencies mentioned in the tables above are specific for this starter kit.</p>
<p>It is important that the clock speeds are known to the code, for proper calculations of speeds and baud rates. If the HFXO or LFXO are different from the speeds above, ensure to pass <code>EFM32_HFXO_FREQ=freq_in_hz</code> and <code>EFM32_LFXO_FREQ=freq_in_hz</code> to your compiler.</p>
<p>You can override the branch's clock source by adding <code>CLOCK_LFA=source</code> to your compiler defines, e.g. <code>CLOCK_LFA=cmuSelect_LFRCO</code>.</p>
<h2>Flashing the device</h2>
<p>To flash, <a href="https://www.segger.com/jlink-software.html">SEGGER JLink</a> is required.</p>
<p>Flashing is supported by RIOT-OS using the command below:</p>
<div class="fragment"><div class="line">make flash</div></div><!-- fragment --><p>To run the GDB debugger, use the command:</p>
<div class="fragment"><div class="line">make debug</div></div><!-- fragment --><p>Or, to connect with your own debugger:</p>
<div class="fragment"><div class="line">make debug-server</div></div><!-- fragment --><p>Some boards have (limited) support for emulation, which can be started with:</p>
<div class="fragment"><div class="line">make emulate</div></div><!-- fragment --><h2>Supported Toolchains</h2>
<p>For using the IKEA TRåDFRI module we strongly recommend the usage of the <a href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm">GNU Tools for ARM Embedded Processors</a> toolchain.</p>
<h2>License information</h2>
<p>Silicon Labs' EMLIB: zlib-style license (permits distribution of source). </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:ikea-tradfri_2include_2board_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ikea-tradfri_2include_2board_8h.html">board.h</a></td></tr>
<tr class="memdesc:ikea-tradfri_2include_2board_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific definitions for the IKEA TRÅDFRI modules. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ikea-tradfri_2include_2gpio__params_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ikea-tradfri_2include_2gpio__params_8h.html">gpio_params.h</a></td></tr>
<tr class="memdesc:ikea-tradfri_2include_2gpio__params_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Board specific configuration of direct mapped GPIOs. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:boards_2ikea-tradfri_2include_2periph__conf_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boards_2ikea-tradfri_2include_2periph__conf_8h.html">periph_conf.h</a></td></tr>
<tr class="memdesc:boards_2ikea-tradfri_2include_2periph__conf_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration of CPU peripherals for the IKEA TRÅDFRI modules. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
    <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
        <ul>
            <li class="footer">Generated on Thu Jul 2 2020 15:49:28 by <a href="http://www.doxygen.org/index.html">
                       <img class="footer" src="doxygen.png" alt="doxygen"></a> 1.8.13</li>
        </ul>
    </div>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap.min.js"></script>
    <script src="jquery.smartmenus.min.js"></script>
    <script src="jquery.smartmenus.bootstrap.min.js"></script>
    <script src="riot-doxy.js"></script>
  </body>
</html>
